(self.webpackChunkgithub_devops_frontend=self.webpackChunkgithub_devops_frontend||[]).push([[2447],{30928:(e,t,n)=>{"use strict";n.d(t,{E:()=>P,h:()=>I});var s={};n.r(s),n.d(s,{Decoder:()=>E,Encoder:()=>k,PacketType:()=>v,protocol:()=>b});var i=n(65043),r=n(35475),o=n(58039);var c=n(53871);const a="function"===typeof ArrayBuffer,h=Object.prototype.toString,u="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===h.call(Blob),l="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===h.call(File);function d(e){return a&&(e instanceof ArrayBuffer||(e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer)(e))||u&&e instanceof Blob||l&&e instanceof File}function p(e,t){if(!e||"object"!==typeof e)return!1;if(Array.isArray(e)){for(let t=0,n=e.length;t<n;t++)if(p(e[t]))return!0;return!1}if(d(e))return!0;if(e.toJSON&&"function"===typeof e.toJSON&&1===arguments.length)return p(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&p(e[n]))return!0;return!1}function f(e){const t=[],n=e.data,s=e;return s.data=y(n,t),s.attachments=t.length,{packet:s,buffers:t}}function y(e,t){if(!e)return e;if(d(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){const n=new Array(e.length);for(let s=0;s<e.length;s++)n[s]=y(e[s],t);return n}if("object"===typeof e&&!(e instanceof Date)){const n={};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(n[s]=y(e[s],t));return n}return e}function g(e,t){return e.data=_(e.data,t),delete e.attachments,e}function _(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"===typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=_(e[n],t);else if("object"===typeof e)for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=_(e[n],t));return e}const m=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],b=5;var v;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(v||(v={}));class k{constructor(e){this.replacer=e}encode(e){return e.type!==v.EVENT&&e.type!==v.ACK||!p(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===v.EVENT?v.BINARY_EVENT:v.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==v.BINARY_EVENT&&e.type!==v.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=f(e),n=this.encodeAsString(t.packet),s=t.buffers;return s.unshift(n),s}}function A(e){return"[object Object]"===Object.prototype.toString.call(e)}class E extends c.v{constructor(e){super(),this.reviver=e}add(e){let t;if("string"===typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===v.BINARY_EVENT;n||t.type===v.BINARY_ACK?(t.type=n?v.EVENT:v.ACK,this.reconstructor=new C(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!d(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===v[n.type])throw new Error("unknown packet type "+n.type);if(n.type===v.BINARY_EVENT||n.type===v.BINARY_ACK){const s=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const i=e.substring(s,t);if(i!=Number(i)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(i)}if("/"===e.charAt(t+1)){const s=t+1;for(;++t;){if(","===e.charAt(t))break;if(t===e.length)break}n.nsp=e.substring(s,t)}else n.nsp="/";const s=e.charAt(t+1);if(""!==s&&Number(s)==s){const s=t+1;for(;++t;){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(s,t+1))}if(e.charAt(++t)){const s=this.tryParse(e.substr(t));if(!E.isPayloadValid(n.type,s))throw new Error("invalid payload");n.data=s}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(t){return!1}}static isPayloadValid(e,t){switch(e){case v.CONNECT:return A(t);case v.DISCONNECT:return void 0===t;case v.CONNECT_ERROR:return"string"===typeof t||A(t);case v.EVENT:case v.BINARY_EVENT:return Array.isArray(t)&&("number"===typeof t[0]||"string"===typeof t[0]&&-1===m.indexOf(t[0]));case v.ACK:case v.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class C{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=g(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function w(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const O=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class R extends c.v{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[w(e,"open",this.onopen.bind(this)),w(e,"packet",this.onpacket.bind(this)),w(e,"error",this.onerror.bind(this)),w(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.unshift("message"),this.emit.apply(this,t),this}emit(e){var t,n,s;if(O.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');for(var i=arguments.length,r=new Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];if(r.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const c={type:v.EVENT,data:r,options:{}};if(c.options.compress=!1!==this.flags.compress,"function"===typeof r[r.length-1]){const e=this.ids++,t=r.pop();this._registerAckCallback(e,t),c.id=e}const a=null===(n=null===(t=this.io.engine)||void 0===t?void 0:t.transport)||void 0===n?void 0:n.writable,h=this.connected&&!(null===(s=this.io.engine)||void 0===s?void 0:s._hasPingExpired());return this.flags.volatile&&!a||(h?(this.notifyOutgoingListeners(c),this.packet(c)):this.sendBuffer.push(c)),this.flags={},this}_registerAckCallback(e,t){var n,s=this;const i=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0===i)return void(this.acks[e]=t);const r=this.io.setTimeoutFn((()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))}),i),o=function(){s.io.clearTimeoutFn(r);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];t.apply(s,n)};o.withError=!0,this.acks[e]=o}emitWithAck(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return new Promise(((t,s)=>{const i=(e,n)=>e?s(e):t(n);i.withError=!0,n.push(i),this.emit(e,...n)}))}_addToQueue(e){var t=this;let n;"function"===typeof e[e.length-1]&&(n=e.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((function(e){if(s!==t._queue[0])return;if(null!==e)s.tryCount>t._opts.retries&&(t._queue.shift(),n&&n(e));else if(t._queue.shift(),n){for(var i=arguments.length,r=new Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];n(null,...r)}return s.pending=!1,t._drainQueue()})),this._queue.push(s),this._drainQueue()}_drainQueue(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.connected||0===this._queue.length)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth((e=>{this._sendConnectPacket(e)})):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:v.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach((e=>{if(!this.sendBuffer.some((t=>String(t.id)===e))){const t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,new Error("socket has been disconnected"))}}))}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case v.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case v.EVENT:case v.BINARY_EVENT:this.onevent(e);break;case v.ACK:case v.BINARY_ACK:this.onack(e);break;case v.DISCONNECT:this.ondisconnect();break;case v.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"===typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(){if(!n){n=!0;for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];t.packet({type:v.ACK,id:e,data:i})}}}onack(e){const t=this.acks[e.id];"function"===typeof t&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((e=>this.emitEvent(e))),this.receiveBuffer=[],this.sendBuffer.forEach((e=>{this.notifyOutgoingListeners(e),this.packet(e)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((e=>e())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:v.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function N(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}N.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},N.prototype.reset=function(){this.attempts=0},N.prototype.setMin=function(e){this.ms=e},N.prototype.setMax=function(e){this.max=e},N.prototype.setJitter=function(e){this.jitter=e};class x extends c.v{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&"object"===typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,(0,o._7)(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=t.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new N({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const i=t.parser||s;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new o.yQ(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const s=w(t,"open",(function(){n.onopen(),e&&e()})),i=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},r=w(t,"error",i);if(!1!==this._timeout){const e=this._timeout,n=this.setTimeoutFn((()=>{s(),i(new Error("timeout")),t.close()}),e);this.opts.autoUnref&&n.unref(),this.subs.push((()=>{this.clearTimeoutFn(n)}))}return this.subs.push(s),this.subs.push(r),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(w(e,"ping",this.onping.bind(this)),w(e,"data",this.ondata.bind(this)),w(e,"error",this.onerror.bind(this)),w(e,"close",this.onclose.bind(this)),w(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){(0,o.dY)((()=>{this.emitReserved("packet",e)}),this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new R(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const n of t){if(this.nsps[n].active)return}this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach((e=>e())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var n;this.cleanup(),null===(n=this.engine)||void 0===n||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn((()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()})))}),t);this.opts.autoUnref&&n.unref(),this.subs.push((()=>{this.clearTimeoutFn(n)}))}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const j={};function S(e,t){"object"===typeof e&&(t=e,e=void 0);const n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,s=e;n=n||"undefined"!==typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e="undefined"!==typeof n?n.protocol+"//"+e:"https://"+e),s=(0,o.qg)(e)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const i=-1!==s.host.indexOf(":")?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+i+":"+s.port+t,s.href=s.protocol+"://"+i+(n&&n.port===s.port?"":":"+s.port),s}(e,(t=t||{}).path||"/socket.io"),s=n.source,i=n.id,r=n.path,c=j[i]&&r in j[i].nsps;let a;return t.forceNew||t["force new connection"]||!1===t.multiplex||c?a=new x(s,t):(j[i]||(j[i]=new x(s,t)),a=j[i]),n.query&&!t.query&&(t.query=n.queryKey),a.socket(n.path,t)}Object.assign(S,{Manager:x,Socket:R,io:S,connect:S});var T=n(16569),B=n(70579);const L=(0,i.createContext)(void 0),P=e=>{let{children:t}=e;const[n]=(0,r.ok)(),s=n.get("id"),[o,c]=(0,i.useState)({}),[a,h]=(0,i.useState)({}),u=(0,i.useRef)(null);(0,i.useEffect)((()=>{if(!s)return;const e=localStorage.getItem("github_token");return u.current=S({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_WS_URL||"ws://localhost:3000",{auth:{token:`Bearer ${e}`}}),u.current.on("connect",(()=>{var e;console.log("WebSocket connected"),null===(e=u.current)||void 0===e||e.emit("subscribe_repo",s)})),u.current.on("connect_error",(e=>{console.error("Connection error:",e),T.Ay.error("WebSocket connection failed")})),u.current.on("error",(e=>{console.error("WebSocket error:",e),T.Ay.error(e.data.message)})),u.current.on("workflow_job",(e=>{console.log(e)})),u.current.on("deployment",(e=>{console.log(e),h(e)})),u.current.on("change",(e=>{c(e)})),()=>{u.current&&(u.current.emit("unsubscribe_repo",s),u.current.disconnect())}}),[s]);const l={changeMsg:o,deployMsg:a};return(0,B.jsx)(L.Provider,{value:l,children:t})},I=()=>{const e=(0,i.useContext)(L);if(void 0===e)throw new Error("useUser must be used within a UserProvider");return e}},41146:(e,t,n)=>{"use strict";var s=n(65043),i=n(84391),r=n(35475),o=n(73216),c=n(82907),a=n(98964),h=n(35735),u=n(77170),l=n(51109),d=n(70579);const p=(0,s.createContext)(void 0),f=e=>{let{children:t}=e;const[n,i]=(0,s.useState)(null),[r,o]=(0,s.useState)(!0),[c,a]=(0,s.useState)(null);(0,s.useEffect)((()=>{localStorage.getItem("github_token")?l.y.getCurrentUser().then(i).catch(a).finally((()=>o(!1))):o(!1)}),[]);const h={user:n,loading:r,error:c,login:l.y.login,logout:l.y.logout};return(0,d.jsx)(p.Provider,{value:h,children:t})};var y=n(30928),g=n(66748),_=n(27732),m=n(52536),b=n(10898),v=n(2761),k=n(36160),A=n(53722);const{Header:E}=a.A,{Text:C}=g.A,w=()=>{const{user:e,loading:t,login:n,logout:i}=(()=>{const e=(0,s.useContext)(p);if(void 0===e)throw new Error("useUser must be used within a UserProvider");return e})(),r=[{key:"logout",icon:(0,d.jsx)(k.A,{}),label:"Logout",onClick:i}];return(0,d.jsxs)(E,{style:{background:"#fff",padding:"0 24px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,d.jsx)("div",{className:"logo",children:(0,d.jsx)(C,{strong:!0,style:{fontSize:"18px"},children:"GitHub DevOps"})}),(0,d.jsx)("div",{children:t?(0,d.jsx)(_.Ay,{loading:!0,children:"Loading..."}):e?(0,d.jsx)(m.A,{menu:{items:r},placement:"bottomRight",children:(0,d.jsxs)(b.A,{style:{cursor:"pointer"},children:[(0,d.jsx)(v.A,{src:null===e||void 0===e?void 0:e.avatar_url}),(0,d.jsx)(C,{children:e.name||e.login})]})}):(0,d.jsx)(_.Ay,{type:"primary",icon:(0,d.jsx)(A.A,{}),onClick:n,children:"Login with GitHub"})})]})};var O=n(11918),R=n(24762),N=n(31765),x=n(61511),j=n(38818);const{Sider:S}=a.A,T=()=>{const e=(0,o.Zp)(),t=(0,o.zy)(),n=[{key:"repositories",label:"\u4ed3\u5e93",icon:(0,d.jsx)(R.A,{}),children:[{key:"/",label:"\u9879\u76ee\u4ed3\u5e93",icon:(0,d.jsx)(N.A,{})}]},{key:"workItems",label:"\u5de5\u4f5c\u9879",icon:(0,d.jsx)(x.A,{}),children:[{key:"/work-items/list",label:"\u5de5\u4f5c\u9879\u5217\u8868"},{key:"/work-items/board",label:"\u770b\u677f\u89c6\u56fe"}]},{key:"team",label:"\u56e2\u961f",icon:(0,d.jsx)(j.A,{}),children:[{key:"/team/members",label:"\u6210\u5458\u7ba1\u7406"}]}];return(0,d.jsx)(S,{width:200,style:{background:"#fff",borderRight:"1px solid #f0f0f0"},children:(0,d.jsx)(O.A,{mode:"inline",selectedKeys:[t.pathname],defaultOpenKeys:["repositories","workItems","team"],style:{height:"100%",borderRight:0},items:n,onClick:t=>{let{key:n}=t;return e(n)}})})},B=(0,s.lazy)((()=>Promise.all([n.e(2166),n.e(7348),n.e(6282),n.e(8270),n.e(87),n.e(2136),n.e(6855),n.e(6627),n.e(8258),n.e(433),n.e(7614),n.e(3342),n.e(512),n.e(4462),n.e(7600),n.e(1012),n.e(6844),n.e(7098),n.e(8032)]).then(n.bind(n,78032)))),L=(0,s.lazy)((()=>Promise.all([n.e(2166),n.e(7348),n.e(6282),n.e(8270),n.e(87),n.e(2136),n.e(6855),n.e(6627),n.e(8258),n.e(433),n.e(7614),n.e(3342),n.e(512),n.e(4462),n.e(7600),n.e(1012),n.e(6844),n.e(7098),n.e(7939)]).then(n.bind(n,57939)))),P=(0,s.lazy)((()=>Promise.all([n.e(2166),n.e(7348),n.e(6282),n.e(8270),n.e(87),n.e(2136),n.e(6855),n.e(6627),n.e(8258),n.e(433),n.e(7614),n.e(3342),n.e(512),n.e(4462),n.e(7600),n.e(1012),n.e(6844),n.e(7098),n.e(5495),n.e(8577),n.e(409)]).then(n.bind(n,23499)))),I=(0,s.lazy)((()=>Promise.all([n.e(2166),n.e(7348),n.e(6282),n.e(8270),n.e(87),n.e(2136),n.e(6855),n.e(6627),n.e(8258),n.e(433),n.e(7614),n.e(3342),n.e(512),n.e(4462),n.e(7600),n.e(1012),n.e(6844),n.e(7098),n.e(6604)]).then(n.bind(n,16604)))),D=(0,s.lazy)((()=>Promise.all([n.e(2166),n.e(7348),n.e(6282),n.e(8270),n.e(87),n.e(2136),n.e(6855),n.e(6627),n.e(8258),n.e(433),n.e(7614),n.e(3342),n.e(512),n.e(4462),n.e(7600),n.e(1012),n.e(6844),n.e(7098),n.e(7689),n.e(9572),n.e(5405)]).then(n.bind(n,91186)))),F=(0,s.lazy)((()=>Promise.all([n.e(2166),n.e(7348),n.e(6282),n.e(8270),n.e(87),n.e(2136),n.e(6855),n.e(6627),n.e(8258),n.e(433),n.e(7614),n.e(3342),n.e(512),n.e(4462),n.e(7600),n.e(1012),n.e(6844),n.e(7098),n.e(9369)]).then(n.bind(n,79369)))),{Content:K}=a.A,V=new c.QueryClient;const q=function(){return(0,d.jsx)(h.Ay,{theme:{algorithm:u.A.defaultAlgorithm,token:{colorPrimary:"#1890ff",borderRadius:8,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)"}},children:(0,d.jsx)(c.QueryClientProvider,{client:V,children:(0,d.jsx)(f,{children:(0,d.jsx)(r.Kd,{children:(0,d.jsxs)(a.A,{className:"app-layout",children:[(0,d.jsx)(w,{}),(0,d.jsxs)(a.A,{children:[(0,d.jsx)(T,{}),(0,d.jsx)(K,{className:"app-content",children:(0,d.jsx)(s.Suspense,{children:(0,d.jsxs)(o.BV,{children:[(0,d.jsx)(o.qh,{path:"/",element:(0,d.jsx)(B,{})}),(0,d.jsx)(o.qh,{path:"/auth/callback",element:(0,d.jsx)(L,{})}),(0,d.jsx)(o.qh,{path:"/repository/:repoName",element:(0,d.jsx)(y.E,{children:(0,d.jsx)(P,{})})}),(0,d.jsx)(o.qh,{path:"/work-items/list",element:(0,d.jsx)(I,{})}),(0,d.jsx)(o.qh,{path:"/work-items/board",element:(0,d.jsx)(D,{})}),(0,d.jsx)(o.qh,{path:"/team/members",element:(0,d.jsx)(F,{})})]})})})]})]})})})})})},U=e=>{e&&e instanceof Function&&n.e(6453).then(n.bind(n,46453)).then((t=>{let{getCLS:n,getFID:s,getFCP:i,getLCP:r,getTTFB:o}=t;n(e),s(e),i(e),r(e),o(e)}))};n(28437);var z=n(16871),M=n(52131);const Y={DIFFVIEWER:{name:"diff-viewer",entry:"http://localhost:3002/",activeRule:"/:appId/detail/:id/kanban",container:"#subapp"}};(0,z.ni)(),(0,M.y)(Object.values(Y));i.createRoot(document.getElementById("root")).render((0,d.jsx)(q,{})),U(console.log)},51109:(e,t,n)=>{"use strict";n.d(t,{y:()=>i});var s=n(30301);const i={login:()=>{const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_GITHUB_CLIENT_ID,t=`${window.location.origin}/auth/callback`;window.location.href=`https://github.com/login/oauth/authorize?client_id=${e}&redirect_uri=${t}&scope=repo,user`},handleCallback:async e=>{const t=await s.A.post("/auth/callback",{code:e}),{access_token:n}=t.data;return localStorage.setItem("github_token",n),n},getCurrentUser:async()=>(await s.A.get("/auth/user")).data,logout:()=>{localStorage.removeItem("github_token"),window.location.href="/"}}},30301:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var s=n(98368),i=n(16569);const r=s.A.create({baseURL:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL,timeout:1e4});r.interceptors.request.use((e=>{const t=localStorage.getItem("github_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e}),(e=>Promise.reject(e))),r.interceptors.response.use((e=>e),(e=>{if(e.response)switch(e.response.status){case 401:i.Ay.error("\u767b\u5f55\u5df2\u8fc7\u671f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55");break;case 403:i.Ay.error("\u6ca1\u6709\u6743\u9650\u8bbf\u95ee");break;case 404:i.Ay.error("\u8bf7\u6c42\u7684\u8d44\u6e90\u4e0d\u5b58\u5728");break;case 500:i.Ay.error("\u670d\u52a1\u5668\u9519\u8bef");break;default:i.Ay.error("\u672a\u77e5\u9519\u8bef")}else e.request?i.Ay.error("\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u8fde\u63a5"):i.Ay.error("\u8bf7\u6c42\u914d\u7f6e\u9519\u8bef");return Promise.reject(e)}));const o=r},40139:e=>{e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],s=0;s<e.rangeCount;s++)n.push(e.getRangeAt(s));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}},53871:(e,t,n)=>{"use strict";function s(e){if(e)return function(e){for(var t in s.prototype)e[t]=s.prototype[t];return e}(e)}n.d(t,{v:()=>s}),s.prototype.on=s.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},s.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},s.prototype.off=s.prototype.removeListener=s.prototype.removeAllListeners=s.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,s=this._callbacks["$"+e];if(!s)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<s.length;i++)if((n=s[i])===t||n.fn===t){s.splice(i,1);break}return 0===s.length&&delete this._callbacks["$"+e],this},s.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],s=1;s<arguments.length;s++)t[s-1]=arguments[s];if(n){s=0;for(var i=(n=n.slice(0)).length;s<i;++s)n[s].apply(this,t)}return this},s.prototype.emitReserved=s.prototype.emit,s.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},s.prototype.hasListeners=function(e){return!!this.listeners(e).length}}},e=>{e.O(0,[9465,6915,9444,3087,5271,9402,4868,16,2621,4095,9040,5430,6361,598,2784,511,8122,3052,2660,7794,6435,7749,2731,4259,5258,9645,3019,8001],(()=>{return t=41146,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=main-dcb821d8.371d9170.js.map