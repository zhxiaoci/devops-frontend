{"version":3,"file":"static/js/main-2b4841d6.53805933.js","mappings":"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","sources":["../node_modules/import-html-entry/esm/allSettledButCanBreak.js","../node_modules/import-html-entry/esm/utils.js","../node_modules/import-html-entry/esm/process-tpl.js","../node_modules/import-html-entry/esm/index.js","../node_modules/engine.io-parser/build/esm/commons.js","../node_modules/engine.io-parser/build/esm/encodePacket.browser.js","../node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js","../node_modules/engine.io-parser/build/esm/decodePacket.browser.js","../node_modules/engine.io-parser/build/esm/index.js","../node_modules/engine.io-client/build/esm/globals.js","../node_modules/engine.io-client/build/esm/util.js","../node_modules/engine.io-client/build/esm/transport.js","../node_modules/engine.io-client/build/esm/contrib/parseqs.js","../node_modules/engine.io-client/build/esm/transports/polling.js","../node_modules/engine.io-client/build/esm/contrib/has-cors.js","../node_modules/engine.io-client/build/esm/transports/polling-xhr.js","../node_modules/engine.io-client/build/esm/transports/websocket.js","../node_modules/engine.io-client/build/esm/transports/index.js","../node_modules/engine.io-client/build/esm/transports/webtransport.js","../node_modules/engine.io-client/build/esm/contrib/parseuri.js","../node_modules/engine.io-client/build/esm/socket.js"],"sourcesContent":["export function allSettledButCanBreak(promises, shouldBreakWhileError) {\n  return Promise.all(promises.map(function (promise, i) {\n    return promise.then(function (value) {\n      return {\n        status: 'fulfilled',\n        value: value\n      };\n    })[\"catch\"](function (reason) {\n      if (shouldBreakWhileError !== null && shouldBreakWhileError !== void 0 && shouldBreakWhileError(i)) {\n        throw reason;\n      }\n      return {\n        status: 'rejected',\n        reason: reason\n      };\n    });\n  }));\n  ;\n}","import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\n/**\n * @author Kuitos\n * @homepage https://github.com/kuitos/\n * @since 2019-02-25\n * fork from https://github.com/systemjs/systemjs/blob/master/src/extras/global.js\n */\n\nvar isIE11 = typeof navigator !== 'undefined' && navigator.userAgent.indexOf('Trident') !== -1;\nfunction shouldSkipProperty(global, p) {\n  if (!global.hasOwnProperty(p) || !isNaN(p) && p < global.length) return true;\n  if (isIE11) {\n    // https://github.com/kuitos/import-html-entry/pull/32，最小化 try 范围\n    try {\n      return global[p] && typeof window !== 'undefined' && global[p].parent === window;\n    } catch (err) {\n      return true;\n    }\n  } else {\n    return false;\n  }\n}\n\n// safari unpredictably lists some new globals first or second in object order\nvar firstGlobalProp, secondGlobalProp, lastGlobalProp;\nexport function getGlobalProp(global) {\n  var cnt = 0;\n  var lastProp;\n  var hasIframe = false;\n  for (var p in global) {\n    if (shouldSkipProperty(global, p)) continue;\n\n    // 遍历 iframe，检查 window 上的属性值是否是 iframe，是则跳过后面的 first 和 second 判断\n    for (var i = 0; i < window.frames.length && !hasIframe; i++) {\n      var frame = window.frames[i];\n      if (frame === global[p]) {\n        hasIframe = true;\n        break;\n      }\n    }\n    if (!hasIframe && (cnt === 0 && p !== firstGlobalProp || cnt === 1 && p !== secondGlobalProp)) return p;\n    cnt++;\n    lastProp = p;\n  }\n  if (lastProp !== lastGlobalProp) return lastProp;\n}\nexport function noteGlobalProps(global) {\n  // alternatively Object.keys(global).pop()\n  // but this may be faster (pending benchmarks)\n  firstGlobalProp = secondGlobalProp = undefined;\n  for (var p in global) {\n    if (shouldSkipProperty(global, p)) continue;\n    if (!firstGlobalProp) firstGlobalProp = p;else if (!secondGlobalProp) secondGlobalProp = p;\n    lastGlobalProp = p;\n  }\n  return lastGlobalProp;\n}\nexport function getInlineCode(match) {\n  var start = match.indexOf('>') + 1;\n  var end = match.lastIndexOf('<');\n  return match.substring(start, end);\n}\nexport function defaultGetPublicPath(entry) {\n  if (_typeof(entry) === 'object') {\n    return '/';\n  }\n  try {\n    var _URL = new URL(entry, location.href),\n      origin = _URL.origin,\n      pathname = _URL.pathname;\n    var paths = pathname.split('/');\n    // 移除最后一个元素\n    paths.pop();\n    return \"\".concat(origin).concat(paths.join('/'), \"/\");\n  } catch (e) {\n    console.warn(e);\n    return '';\n  }\n}\n\n// Detect whether browser supports `<script type=module>` or not\nexport function isModuleScriptSupported() {\n  var s = document.createElement('script');\n  return 'noModule' in s;\n}\n\n// RIC and shim for browsers setTimeout() without it\nexport var requestIdleCallback = window.requestIdleCallback || function requestIdleCallback(cb) {\n  var start = Date.now();\n  return setTimeout(function () {\n    cb({\n      didTimeout: false,\n      timeRemaining: function timeRemaining() {\n        return Math.max(0, 50 - (Date.now() - start));\n      }\n    });\n  }, 1);\n};\nexport function readResAsString(response, autoDetectCharset) {\n  // 未启用自动检测\n  if (!autoDetectCharset) {\n    return response.text();\n  }\n\n  // 如果没headers，发生在test环境下的mock数据，为兼容原有测试用例\n  if (!response.headers) {\n    return response.text();\n  }\n\n  // 如果没返回content-type，走默认逻辑\n  var contentType = response.headers.get('Content-Type');\n  if (!contentType) {\n    return response.text();\n  }\n\n  // 解析content-type内的charset\n  // Content-Type: text/html; charset=utf-8\n  // Content-Type: multipart/form-data; boundary=something\n  // GET请求下不会出现第二种content-type\n  var charset = 'utf-8';\n  var parts = contentType.split(';');\n  if (parts.length === 2) {\n    var _parts$1$split = parts[1].split('='),\n      _parts$1$split2 = _slicedToArray(_parts$1$split, 2),\n      value = _parts$1$split2[1];\n    var encoding = value && value.trim();\n    if (encoding) {\n      charset = encoding;\n    }\n  }\n\n  // 如果还是utf-8，那么走默认，兼容原有逻辑，这段代码删除也应该工作\n  if (charset.toUpperCase() === 'UTF-8') {\n    return response.text();\n  }\n\n  // 走流读取，编码可能是gbk，gb2312等，比如sofa 3默认是gbk编码\n  return response.blob().then(function (file) {\n    return new Promise(function (resolve, reject) {\n      var reader = new window.FileReader();\n      reader.onload = function () {\n        resolve(reader.result);\n      };\n      reader.onerror = reject;\n      reader.readAsText(file, charset);\n    });\n  });\n}\nvar evalCache = {};\nexport function evalCode(scriptSrc, code) {\n  var key = scriptSrc;\n  if (!evalCache[key]) {\n    var functionWrappedCode = \"(function(){\".concat(code, \"})\");\n    evalCache[key] = (0, eval)(functionWrappedCode);\n  }\n  var evalFunc = evalCache[key];\n  evalFunc.call(window);\n}\n\n// 转换 url 中的转义字符，例如 &amp; => &\nexport function parseUrl(url) {\n  var parser = new DOMParser();\n  var html = \"<script src=\\\"\".concat(url, \"\\\"></script>\");\n  var doc = parser.parseFromString(html, \"text/html\");\n  return doc.scripts[0].src;\n}","import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n/**\n * @author Kuitos\n * @homepage https://github.com/kuitos/\n * @since 2018-09-03 15:04\n */\nimport { getInlineCode, isModuleScriptSupported, parseUrl } from './utils';\nvar ALL_SCRIPT_REGEX = /(<script[\\s\\S]*?>)[\\s\\S]*?<\\/script>/gi;\nvar SCRIPT_TAG_REGEX = /<(script)\\s+((?!type=('|\")text\\/ng\\x2Dtemplate\\3)[\\s\\S])*?>[\\s\\S]*?<\\/\\1>/i;\nvar SCRIPT_SRC_REGEX = /.*\\ssrc=('|\")?([^>'\"\\s]+)/;\nvar SCRIPT_TYPE_REGEX = /.*\\stype=('|\")?([^>'\"\\s]+)/;\nvar SCRIPT_ENTRY_REGEX = /.*\\sentry\\s*.*/;\nvar SCRIPT_ASYNC_REGEX = /.*\\sasync\\s*.*/;\nvar SCRIPT_CROSSORIGIN_REGEX = /.*\\scrossorigin=('|\")?use-credentials\\1/;\nvar SCRIPT_NO_MODULE_REGEX = /.*\\snomodule\\s*.*/;\nvar SCRIPT_MODULE_REGEX = /.*\\stype=('|\")?module('|\")?\\s*.*/;\nvar LINK_TAG_REGEX = /<(link)\\s+[\\s\\S]*?>/ig;\nvar LINK_PRELOAD_OR_PREFETCH_REGEX = /\\srel=('|\")?(preload|prefetch)\\1/;\nvar LINK_HREF_REGEX = /.*\\shref=('|\")?([^>'\"\\s]+)/;\nvar LINK_AS_FONT = /.*\\sas=('|\")?font\\1.*/;\nvar STYLE_TAG_REGEX = /<style[^>]*>[\\s\\S]*?<\\/style>/gi;\nvar STYLE_TYPE_REGEX = /\\s+rel=('|\")?stylesheet\\1.*/;\nvar STYLE_HREF_REGEX = /.*\\shref=('|\")?([^>'\"\\s]+)/;\nvar HTML_COMMENT_REGEX = /<!--([\\s\\S]*?)-->/g;\nvar LINK_IGNORE_REGEX = /<link(\\s+|\\s+[\\s\\S]+\\s+)ignore(\\s*|\\s+[\\s\\S]*|=[\\s\\S]*)>/i;\nvar STYLE_IGNORE_REGEX = /<style(\\s+|\\s+[\\s\\S]+\\s+)ignore(\\s*|\\s+[\\s\\S]*|=[\\s\\S]*)>/i;\nvar SCRIPT_IGNORE_REGEX = /<script(\\s+|\\s+[\\s\\S]+\\s+)ignore(\\s*|\\s+[\\s\\S]*|=[\\s\\S]*)>/i;\nfunction hasProtocol(url) {\n  return url.startsWith('http://') || url.startsWith('https://');\n}\nfunction getEntirePath(path, baseURI) {\n  return new URL(path, baseURI).toString();\n}\nfunction isValidJavaScriptType(type) {\n  var handleTypes = ['text/javascript', 'module', 'application/javascript', 'text/ecmascript', 'application/ecmascript'];\n  return !type || handleTypes.indexOf(type) !== -1;\n}\nexport var genLinkReplaceSymbol = function genLinkReplaceSymbol(linkHref) {\n  var preloadOrPrefetch = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  return \"<!-- \".concat(preloadOrPrefetch ? 'prefetch/preload' : '', \" link \").concat(linkHref, \" replaced by import-html-entry -->\");\n};\nexport var genScriptReplaceSymbol = function genScriptReplaceSymbol(scriptSrc) {\n  var async = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var crossOrigin = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  return \"<!-- \".concat(crossOrigin ? 'cors' : '', \" \").concat(async ? 'async' : '', \" script \").concat(scriptSrc, \" replaced by import-html-entry -->\");\n};\nexport var inlineScriptReplaceSymbol = \"<!-- inline scripts replaced by import-html-entry -->\";\nexport var genIgnoreAssetReplaceSymbol = function genIgnoreAssetReplaceSymbol(url) {\n  return \"<!-- ignore asset \".concat(url || 'file', \" replaced by import-html-entry -->\");\n};\nexport var genModuleScriptReplaceSymbol = function genModuleScriptReplaceSymbol(scriptSrc, moduleSupport) {\n  return \"<!-- \".concat(moduleSupport ? 'nomodule' : 'module', \" script \").concat(scriptSrc, \" ignored by import-html-entry -->\");\n};\n\n/**\n * parse the script link from the template\n * 1. collect stylesheets\n * 2. use global eval to evaluate the inline scripts\n *    see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function#Difference_between_Function_constructor_and_function_declaration\n *    see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval#Do_not_ever_use_eval!\n * @param tpl\n * @param baseURI\n * @param postProcessTemplate\n * @stripStyles whether to strip the css links\n * @returns {{template: void | string | *, scripts: *[], entry: *}}\n */\nexport default function processTpl(tpl, baseURI, postProcessTemplate) {\n  var scripts = [];\n  var styles = [];\n  var entry = null;\n  var moduleSupport = isModuleScriptSupported();\n  var template = tpl\n\n  /*\n  remove html comment first\n  */.replace(HTML_COMMENT_REGEX, '').replace(LINK_TAG_REGEX, function (match) {\n    /*\n    change the css link\n    */\n    var styleType = !!match.match(STYLE_TYPE_REGEX);\n    if (styleType) {\n      var styleHref = match.match(STYLE_HREF_REGEX);\n      var styleIgnore = match.match(LINK_IGNORE_REGEX);\n      if (styleHref) {\n        var href = styleHref && styleHref[2];\n        var newHref = href;\n        if (href && !hasProtocol(href)) {\n          newHref = getEntirePath(href, baseURI);\n        }\n        if (styleIgnore) {\n          return genIgnoreAssetReplaceSymbol(newHref);\n        }\n        newHref = parseUrl(newHref);\n        styles.push(newHref);\n        return genLinkReplaceSymbol(newHref);\n      }\n    }\n    var preloadOrPrefetchType = match.match(LINK_PRELOAD_OR_PREFETCH_REGEX) && match.match(LINK_HREF_REGEX) && !match.match(LINK_AS_FONT);\n    if (preloadOrPrefetchType) {\n      var _match$match = match.match(LINK_HREF_REGEX),\n        _match$match2 = _slicedToArray(_match$match, 3),\n        linkHref = _match$match2[2];\n      return genLinkReplaceSymbol(linkHref, true);\n    }\n    return match;\n  }).replace(STYLE_TAG_REGEX, function (match) {\n    if (STYLE_IGNORE_REGEX.test(match)) {\n      return genIgnoreAssetReplaceSymbol('style file');\n    }\n    return match;\n  }).replace(ALL_SCRIPT_REGEX, function (match, scriptTag) {\n    var scriptIgnore = scriptTag.match(SCRIPT_IGNORE_REGEX);\n    var moduleScriptIgnore = moduleSupport && !!scriptTag.match(SCRIPT_NO_MODULE_REGEX) || !moduleSupport && !!scriptTag.match(SCRIPT_MODULE_REGEX);\n    // in order to keep the exec order of all javascripts\n\n    var matchedScriptTypeMatch = scriptTag.match(SCRIPT_TYPE_REGEX);\n    var matchedScriptType = matchedScriptTypeMatch && matchedScriptTypeMatch[2];\n    if (!isValidJavaScriptType(matchedScriptType)) {\n      return match;\n    }\n\n    // if it is a external script\n    if (SCRIPT_TAG_REGEX.test(match) && scriptTag.match(SCRIPT_SRC_REGEX)) {\n      /*\n      collect scripts and replace the ref\n      */\n\n      var matchedScriptEntry = scriptTag.match(SCRIPT_ENTRY_REGEX);\n      var matchedScriptSrcMatch = scriptTag.match(SCRIPT_SRC_REGEX);\n      var matchedScriptSrc = matchedScriptSrcMatch && matchedScriptSrcMatch[2];\n      if (entry && matchedScriptEntry) {\n        throw new SyntaxError('You should not set multiply entry script!');\n      }\n      if (matchedScriptSrc) {\n        // append the domain while the script not have a protocol prefix\n        if (!hasProtocol(matchedScriptSrc)) {\n          matchedScriptSrc = getEntirePath(matchedScriptSrc, baseURI);\n        }\n        matchedScriptSrc = parseUrl(matchedScriptSrc);\n      }\n      entry = entry || matchedScriptEntry && matchedScriptSrc;\n      if (scriptIgnore) {\n        return genIgnoreAssetReplaceSymbol(matchedScriptSrc || 'js file');\n      }\n      if (moduleScriptIgnore) {\n        return genModuleScriptReplaceSymbol(matchedScriptSrc || 'js file', moduleSupport);\n      }\n      if (matchedScriptSrc) {\n        var asyncScript = !!scriptTag.match(SCRIPT_ASYNC_REGEX);\n        var crossOriginScript = !!scriptTag.match(SCRIPT_CROSSORIGIN_REGEX);\n        scripts.push(asyncScript || crossOriginScript ? {\n          async: asyncScript,\n          src: matchedScriptSrc,\n          crossOrigin: crossOriginScript\n        } : matchedScriptSrc);\n        return genScriptReplaceSymbol(matchedScriptSrc, asyncScript, crossOriginScript);\n      }\n      return match;\n    } else {\n      if (scriptIgnore) {\n        return genIgnoreAssetReplaceSymbol('js file');\n      }\n      if (moduleScriptIgnore) {\n        return genModuleScriptReplaceSymbol('js file', moduleSupport);\n      }\n\n      // if it is an inline script\n      var code = getInlineCode(match);\n\n      // remove script blocks when all of these lines are comments.\n      var isPureCommentBlock = code.split(/[\\r\\n]+/).every(function (line) {\n        return !line.trim() || line.trim().startsWith('//');\n      });\n      if (!isPureCommentBlock) {\n        scripts.push(match);\n      }\n      return inlineScriptReplaceSymbol;\n    }\n  });\n  scripts = scripts.filter(function (script) {\n    // filter empty script\n    return !!script;\n  });\n  var tplResult = {\n    template: template,\n    scripts: scripts,\n    styles: styles,\n    // set the last script as entry if have not set\n    entry: entry || scripts[scripts.length - 1]\n  };\n  if (typeof postProcessTemplate === 'function') {\n    tplResult = postProcessTemplate(tplResult);\n  }\n  return tplResult;\n}","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n/**\n * @author Kuitos\n * @homepage https://github.com/kuitos/\n * @since 2018-08-15 11:37\n */\n\nimport { allSettledButCanBreak } from './allSettledButCanBreak';\nimport processTpl, { genLinkReplaceSymbol, genScriptReplaceSymbol } from './process-tpl';\nimport { defaultGetPublicPath, evalCode, getGlobalProp, getInlineCode, noteGlobalProps, readResAsString, requestIdleCallback } from './utils';\nvar styleCache = {};\nvar scriptCache = {};\nvar embedHTMLCache = {};\nif (!window.fetch) {\n  throw new Error('[import-html-entry] Here is no \"fetch\" on the window env, you need to polyfill it');\n}\nvar defaultFetch = window.fetch.bind(window);\nfunction defaultGetTemplate(tpl) {\n  return tpl;\n}\n\n/**\n * convert external css link to inline style for performance optimization\n * @param template\n * @param styles\n * @param opts\n * @return embedHTML\n */\nfunction getEmbedHTML(template, styles) {\n  var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var _opts$fetch = opts.fetch,\n    fetch = _opts$fetch === void 0 ? defaultFetch : _opts$fetch;\n  var embedHTML = template;\n  return _getExternalStyleSheets(styles, fetch).then(function (styleSheets) {\n    embedHTML = styleSheets.reduce(function (html, styleSheet) {\n      var styleSrc = styleSheet.src;\n      var styleSheetContent = styleSheet.value;\n      html = html.replace(genLinkReplaceSymbol(styleSrc), isInlineCode(styleSrc) ? \"\".concat(styleSrc) : \"<style>/* \".concat(styleSrc, \" */\").concat(styleSheetContent, \"</style>\"));\n      return html;\n    }, embedHTML);\n    return embedHTML;\n  });\n}\nvar isInlineCode = function isInlineCode(code) {\n  return code.startsWith('<');\n};\nfunction getExecutableScript(scriptSrc, scriptText) {\n  var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var proxy = opts.proxy,\n    strictGlobal = opts.strictGlobal,\n    _opts$scopedGlobalVar = opts.scopedGlobalVariables,\n    scopedGlobalVariables = _opts$scopedGlobalVar === void 0 ? [] : _opts$scopedGlobalVar;\n  var sourceUrl = isInlineCode(scriptSrc) ? '' : \"//# sourceURL=\".concat(scriptSrc, \"\\n\");\n\n  // 将 scopedGlobalVariables 拼接成变量声明，用于缓存全局变量，避免每次使用时都走一遍代理\n  var scopedGlobalVariableDefinition = scopedGlobalVariables.length ? \"const {\".concat(scopedGlobalVariables.join(','), \"}=this;\") : '';\n\n  // 通过这种方式获取全局 window，因为 script 也是在全局作用域下运行的，所以我们通过 window.proxy 绑定时也必须确保绑定到全局 window 上\n  // 否则在嵌套场景下， window.proxy 设置的是内层应用的 window，而代码其实是在全局作用域运行的，会导致闭包里的 window.proxy 取的是最外层的微应用的 proxy\n  var globalWindow = (0, eval)('window');\n  globalWindow.proxy = proxy;\n  // TODO 通过 strictGlobal 方式切换 with 闭包，待 with 方式坑趟平后再合并\n  return strictGlobal ? scopedGlobalVariableDefinition ? \";(function(){with(this){\".concat(scopedGlobalVariableDefinition).concat(scriptText, \"\\n\").concat(sourceUrl, \"}}).bind(window.proxy)();\") : \";(function(window, self, globalThis){with(window){;\".concat(scriptText, \"\\n\").concat(sourceUrl, \"}}).bind(window.proxy)(window.proxy, window.proxy, window.proxy);\") : \";(function(window, self, globalThis){;\".concat(scriptText, \"\\n\").concat(sourceUrl, \"}).bind(window.proxy)(window.proxy, window.proxy, window.proxy);\");\n}\n\n// for prefetch\nfunction _getExternalStyleSheets(styles) {\n  var fetch = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultFetch;\n  return allSettledButCanBreak(styles.map( /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(styleLink) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            if (!isInlineCode(styleLink)) {\n              _context.next = 4;\n              break;\n            }\n            return _context.abrupt(\"return\", getInlineCode(styleLink));\n          case 4:\n            return _context.abrupt(\"return\", styleCache[styleLink] || (styleCache[styleLink] = fetch(styleLink).then(function (response) {\n              if (response.status >= 400) {\n                throw new Error(\"\".concat(styleLink, \" load failed with status \").concat(response.status));\n              }\n              return response.text();\n            })[\"catch\"](function (e) {\n              try {\n                if (e.message.indexOf(styleLink) === -1) {\n                  e.message = \"\".concat(styleLink, \" \").concat(e.message);\n                }\n              } catch (_) {\n                // e.message 可能是 readonly，此时会触发异常\n              }\n              throw e;\n            })));\n          case 5:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    }));\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }())).then(function (results) {\n    return results.map(function (result, i) {\n      if (result.status === 'fulfilled') {\n        result.value = {\n          src: styles[i],\n          value: result.value\n        };\n      }\n      return result;\n    }).filter(function (result) {\n      // 忽略失败的请求，避免异常下载阻塞后续资源加载\n      if (result.status === 'rejected') {\n        Promise.reject(result.reason);\n      }\n      return result.status === 'fulfilled';\n    }).map(function (result) {\n      return result.value;\n    });\n  });\n}\n\n// for prefetch\nexport { _getExternalStyleSheets as getExternalStyleSheets };\nfunction _getExternalScripts(scripts) {\n  var fetch = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultFetch;\n  var entry = arguments.length > 2 ? arguments[2] : undefined;\n  var fetchScript = function fetchScript(scriptUrl, opts) {\n    return scriptCache[scriptUrl] || (scriptCache[scriptUrl] = fetch(scriptUrl, opts).then(function (response) {\n      // usually browser treats 4xx and 5xx response of script loading as an error and will fire a script error event\n      // https://stackoverflow.com/questions/5625420/what-http-headers-responses-trigger-the-onerror-handler-on-a-script-tag/5625603\n      if (response.status >= 400) {\n        throw new Error(\"\".concat(scriptUrl, \" load failed with status \").concat(response.status));\n      }\n      return response.text();\n    })[\"catch\"](function (e) {\n      try {\n        if (e.message.indexOf(scriptUrl) === -1) {\n          e.message = \"\".concat(scriptUrl, \" \").concat(e.message);\n        }\n      } catch (_) {\n        // e.message 可能是 readonly，此时会触发异常\n      }\n      throw e;\n    }));\n  };\n\n  // entry js 下载失败应该直接 break\n  var shouldBreakWhileError = function shouldBreakWhileError(i) {\n    return scripts[i] === entry;\n  };\n  return allSettledButCanBreak(scripts.map( /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(script) {\n      var src, async, crossOrigin, fetchOpts;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) switch (_context2.prev = _context2.next) {\n          case 0:\n            if (!(typeof script === 'string')) {\n              _context2.next = 8;\n              break;\n            }\n            if (!isInlineCode(script)) {\n              _context2.next = 5;\n              break;\n            }\n            return _context2.abrupt(\"return\", getInlineCode(script));\n          case 5:\n            return _context2.abrupt(\"return\", fetchScript(script));\n          case 6:\n            _context2.next = 13;\n            break;\n          case 8:\n            // use idle time to load async script\n            src = script.src, async = script.async, crossOrigin = script.crossOrigin;\n            fetchOpts = crossOrigin ? {\n              credentials: 'include'\n            } : {};\n            if (!async) {\n              _context2.next = 12;\n              break;\n            }\n            return _context2.abrupt(\"return\", {\n              src: src,\n              async: true,\n              content: new Promise(function (resolve, reject) {\n                return requestIdleCallback(function () {\n                  return fetchScript(src, fetchOpts).then(resolve, reject);\n                });\n              })\n            });\n          case 12:\n            return _context2.abrupt(\"return\", fetchScript(src, fetchOpts));\n          case 13:\n          case \"end\":\n            return _context2.stop();\n        }\n      }, _callee2);\n    }));\n    return function (_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }()), shouldBreakWhileError).then(function (results) {\n    return results.map(function (result, i) {\n      if (result.status === 'fulfilled') {\n        result.value = {\n          src: scripts[i],\n          value: result.value\n        };\n      }\n      return result;\n    }).filter(function (result) {\n      // 忽略失败的请求，避免异常下载阻塞后续资源加载\n      if (result.status === 'rejected') {\n        Promise.reject(result.reason);\n      }\n      return result.status === 'fulfilled';\n    }).map(function (result) {\n      return result.value;\n    });\n  });\n}\nexport { _getExternalScripts as getExternalScripts };\nfunction throwNonBlockingError(error, msg) {\n  setTimeout(function () {\n    console.error(msg);\n    throw error;\n  });\n}\nvar supportsUserTiming = typeof performance !== 'undefined' && typeof performance.mark === 'function' && typeof performance.clearMarks === 'function' && typeof performance.measure === 'function' && typeof performance.clearMeasures === 'function';\n\n/**\n * FIXME to consistent with browser behavior, we should only provide callback way to invoke success and error event\n * @param entry\n * @param scripts\n * @param proxy\n * @param opts\n * @returns {Promise<unknown>}\n */\nfunction _execScripts(entry, scripts) {\n  var proxy = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : window;\n  var opts = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  var _opts$fetch2 = opts.fetch,\n    fetch = _opts$fetch2 === void 0 ? defaultFetch : _opts$fetch2,\n    _opts$strictGlobal = opts.strictGlobal,\n    strictGlobal = _opts$strictGlobal === void 0 ? false : _opts$strictGlobal,\n    success = opts.success,\n    _opts$error = opts.error,\n    error = _opts$error === void 0 ? function () {} : _opts$error,\n    _opts$beforeExec = opts.beforeExec,\n    beforeExec = _opts$beforeExec === void 0 ? function () {} : _opts$beforeExec,\n    _opts$afterExec = opts.afterExec,\n    afterExec = _opts$afterExec === void 0 ? function () {} : _opts$afterExec,\n    _opts$scopedGlobalVar2 = opts.scopedGlobalVariables,\n    scopedGlobalVariables = _opts$scopedGlobalVar2 === void 0 ? [] : _opts$scopedGlobalVar2;\n  return _getExternalScripts(scripts, fetch, entry).then(function (scriptsText) {\n    var geval = function geval(scriptSrc, inlineScript) {\n      var rawCode = beforeExec(inlineScript, scriptSrc) || inlineScript;\n      var code = getExecutableScript(scriptSrc, rawCode, {\n        proxy: proxy,\n        strictGlobal: strictGlobal,\n        scopedGlobalVariables: scopedGlobalVariables\n      });\n      evalCode(scriptSrc, code);\n      afterExec(inlineScript, scriptSrc);\n    };\n    function exec(scriptSrc, inlineScript, resolve) {\n      var markName = \"Evaluating script \".concat(scriptSrc);\n      var measureName = \"Evaluating Time Consuming: \".concat(scriptSrc);\n      if (process.env.NODE_ENV === 'development' && supportsUserTiming) {\n        performance.mark(markName);\n      }\n      if (scriptSrc === entry) {\n        noteGlobalProps(strictGlobal ? proxy : window);\n        try {\n          geval(scriptSrc, inlineScript);\n          var exports = proxy[getGlobalProp(strictGlobal ? proxy : window)] || {};\n          resolve(exports);\n        } catch (e) {\n          // entry error must be thrown to make the promise settled\n          console.error(\"[import-html-entry]: error occurs while executing entry script \".concat(scriptSrc));\n          throw e;\n        }\n      } else {\n        if (typeof inlineScript === 'string') {\n          try {\n            if (scriptSrc !== null && scriptSrc !== void 0 && scriptSrc.src) {\n              geval(scriptSrc.src, inlineScript);\n            } else {\n              geval(scriptSrc, inlineScript);\n            }\n          } catch (e) {\n            // consistent with browser behavior, any independent script evaluation error should not block the others\n            throwNonBlockingError(e, \"[import-html-entry]: error occurs while executing normal script \".concat(scriptSrc));\n          }\n        } else {\n          // external script marked with async\n          inlineScript.async && (inlineScript === null || inlineScript === void 0 ? void 0 : inlineScript.content.then(function (downloadedScriptText) {\n            return geval(inlineScript.src, downloadedScriptText);\n          })[\"catch\"](function (e) {\n            throwNonBlockingError(e, \"[import-html-entry]: error occurs while executing async script \".concat(inlineScript.src));\n          }));\n        }\n      }\n      if (process.env.NODE_ENV === 'development' && supportsUserTiming) {\n        performance.measure(measureName, markName);\n        performance.clearMarks(markName);\n        performance.clearMeasures(measureName);\n      }\n    }\n    function schedule(i, resolvePromise) {\n      if (i < scriptsText.length) {\n        var script = scriptsText[i];\n        var scriptSrc = script.src;\n        var inlineScript = script.value;\n        exec(scriptSrc, inlineScript, resolvePromise);\n        // resolve the promise while the last script executed and entry not provided\n        if (!entry && i === scriptsText.length - 1) {\n          resolvePromise();\n        } else {\n          schedule(i + 1, resolvePromise);\n        }\n      }\n    }\n    return new Promise(function (resolve) {\n      return schedule(0, success || resolve);\n    });\n  })[\"catch\"](function (e) {\n    error();\n    throw e;\n  });\n}\nexport { _execScripts as execScripts };\nexport default function importHTML(url) {\n  var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var fetch = defaultFetch;\n  var autoDecodeResponse = false;\n  var getPublicPath = defaultGetPublicPath;\n  var getTemplate = defaultGetTemplate;\n  var postProcessTemplate = opts.postProcessTemplate;\n\n  // compatible with the legacy importHTML api\n  if (typeof opts === 'function') {\n    fetch = opts;\n  } else {\n    // fetch option is availble\n    if (opts.fetch) {\n      // fetch is a funciton\n      if (typeof opts.fetch === 'function') {\n        fetch = opts.fetch;\n      } else {\n        // configuration\n        fetch = opts.fetch.fn || defaultFetch;\n        autoDecodeResponse = !!opts.fetch.autoDecodeResponse;\n      }\n    }\n    getPublicPath = opts.getPublicPath || opts.getDomain || defaultGetPublicPath;\n    getTemplate = opts.getTemplate || defaultGetTemplate;\n  }\n  return embedHTMLCache[url] || (embedHTMLCache[url] = fetch(url).then(function (response) {\n    return readResAsString(response, autoDecodeResponse);\n  }).then(function (html) {\n    var assetPublicPath = getPublicPath(url);\n    var _processTpl = processTpl(getTemplate(html), assetPublicPath, postProcessTemplate),\n      template = _processTpl.template,\n      scripts = _processTpl.scripts,\n      entry = _processTpl.entry,\n      styles = _processTpl.styles;\n    return getEmbedHTML(template, styles, {\n      fetch: fetch\n    }).then(function (embedHTML) {\n      return {\n        template: embedHTML,\n        assetPublicPath: assetPublicPath,\n        getExternalScripts: function getExternalScripts() {\n          return _getExternalScripts(scripts, fetch);\n        },\n        getExternalStyleSheets: function getExternalStyleSheets() {\n          return _getExternalStyleSheets(styles, fetch);\n        },\n        execScripts: function execScripts(proxy, strictGlobal) {\n          var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n          if (!scripts.length) {\n            return Promise.resolve();\n          }\n          return _execScripts(entry, scripts, proxy, _objectSpread({\n            fetch: fetch,\n            strictGlobal: strictGlobal\n          }, opts));\n        }\n      };\n    });\n  }));\n}\nexport function importEntry(entry) {\n  var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var _opts$fetch3 = opts.fetch,\n    fetch = _opts$fetch3 === void 0 ? defaultFetch : _opts$fetch3,\n    _opts$getTemplate = opts.getTemplate,\n    getTemplate = _opts$getTemplate === void 0 ? defaultGetTemplate : _opts$getTemplate,\n    postProcessTemplate = opts.postProcessTemplate;\n  var getPublicPath = opts.getPublicPath || opts.getDomain || defaultGetPublicPath;\n  if (!entry) {\n    throw new SyntaxError('entry should not be empty!');\n  }\n\n  // html entry\n  if (typeof entry === 'string') {\n    return importHTML(entry, {\n      fetch: fetch,\n      getPublicPath: getPublicPath,\n      getTemplate: getTemplate,\n      postProcessTemplate: postProcessTemplate\n    });\n  }\n\n  // config entry\n  if (Array.isArray(entry.scripts) || Array.isArray(entry.styles)) {\n    var _entry$scripts = entry.scripts,\n      scripts = _entry$scripts === void 0 ? [] : _entry$scripts,\n      _entry$styles = entry.styles,\n      styles = _entry$styles === void 0 ? [] : _entry$styles,\n      _entry$html = entry.html,\n      html = _entry$html === void 0 ? '' : _entry$html;\n    var getHTMLWithStylePlaceholder = function getHTMLWithStylePlaceholder(tpl) {\n      return styles.reduceRight(function (html, styleSrc) {\n        return \"\".concat(genLinkReplaceSymbol(styleSrc)).concat(html);\n      }, tpl);\n    };\n    var getHTMLWithScriptPlaceholder = function getHTMLWithScriptPlaceholder(tpl) {\n      return scripts.reduce(function (html, scriptSrc) {\n        return \"\".concat(html).concat(genScriptReplaceSymbol(scriptSrc));\n      }, tpl);\n    };\n    return getEmbedHTML(getTemplate(getHTMLWithScriptPlaceholder(getHTMLWithStylePlaceholder(html))), styles, {\n      fetch: fetch\n    }).then(function (embedHTML) {\n      return {\n        template: embedHTML,\n        assetPublicPath: getPublicPath(entry),\n        getExternalScripts: function getExternalScripts() {\n          return _getExternalScripts(scripts, fetch);\n        },\n        getExternalStyleSheets: function getExternalStyleSheets() {\n          return _getExternalStyleSheets(styles, fetch);\n        },\n        execScripts: function execScripts(proxy, strictGlobal) {\n          var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n          if (!scripts.length) {\n            return Promise.resolve();\n          }\n          return _execScripts(scripts[scripts.length - 1], scripts, proxy, _objectSpread({\n            fetch: fetch,\n            strictGlobal: strictGlobal\n          }, opts));\n        }\n      };\n    });\n  } else {\n    throw new SyntaxError('entry scripts or styles should be array!');\n  }\n}","const PACKET_TYPES = Object.create(null); // no Map = no polyfill\nPACKET_TYPES[\"open\"] = \"0\";\nPACKET_TYPES[\"close\"] = \"1\";\nPACKET_TYPES[\"ping\"] = \"2\";\nPACKET_TYPES[\"pong\"] = \"3\";\nPACKET_TYPES[\"message\"] = \"4\";\nPACKET_TYPES[\"upgrade\"] = \"5\";\nPACKET_TYPES[\"noop\"] = \"6\";\nconst PACKET_TYPES_REVERSE = Object.create(null);\nObject.keys(PACKET_TYPES).forEach((key) => {\n    PACKET_TYPES_REVERSE[PACKET_TYPES[key]] = key;\n});\nconst ERROR_PACKET = { type: \"error\", data: \"parser error\" };\nexport { PACKET_TYPES, PACKET_TYPES_REVERSE, ERROR_PACKET };\n","import { PACKET_TYPES } from \"./commons.js\";\nconst withNativeBlob = typeof Blob === \"function\" ||\n    (typeof Blob !== \"undefined\" &&\n        Object.prototype.toString.call(Blob) === \"[object BlobConstructor]\");\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\n// ArrayBuffer.isView method is not defined in IE10\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === \"function\"\n        ? ArrayBuffer.isView(obj)\n        : obj && obj.buffer instanceof ArrayBuffer;\n};\nconst encodePacket = ({ type, data }, supportsBinary, callback) => {\n    if (withNativeBlob && data instanceof Blob) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(data, callback);\n        }\n    }\n    else if (withNativeArrayBuffer &&\n        (data instanceof ArrayBuffer || isView(data))) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(new Blob([data]), callback);\n        }\n    }\n    // plain string\n    return callback(PACKET_TYPES[type] + (data || \"\"));\n};\nconst encodeBlobAsBase64 = (data, callback) => {\n    const fileReader = new FileReader();\n    fileReader.onload = function () {\n        const content = fileReader.result.split(\",\")[1];\n        callback(\"b\" + (content || \"\"));\n    };\n    return fileReader.readAsDataURL(data);\n};\nfunction toArray(data) {\n    if (data instanceof Uint8Array) {\n        return data;\n    }\n    else if (data instanceof ArrayBuffer) {\n        return new Uint8Array(data);\n    }\n    else {\n        return new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n    }\n}\nlet TEXT_ENCODER;\nexport function encodePacketToBinary(packet, callback) {\n    if (withNativeBlob && packet.data instanceof Blob) {\n        return packet.data.arrayBuffer().then(toArray).then(callback);\n    }\n    else if (withNativeArrayBuffer &&\n        (packet.data instanceof ArrayBuffer || isView(packet.data))) {\n        return callback(toArray(packet.data));\n    }\n    encodePacket(packet, false, (encoded) => {\n        if (!TEXT_ENCODER) {\n            TEXT_ENCODER = new TextEncoder();\n        }\n        callback(TEXT_ENCODER.encode(encoded));\n    });\n}\nexport { encodePacket };\n","// imported from https://github.com/socketio/base64-arraybuffer\nconst chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n// Use a lookup table to find the index.\nconst lookup = typeof Uint8Array === 'undefined' ? [] : new Uint8Array(256);\nfor (let i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n}\nexport const encode = (arraybuffer) => {\n    let bytes = new Uint8Array(arraybuffer), i, len = bytes.length, base64 = '';\n    for (i = 0; i < len; i += 3) {\n        base64 += chars[bytes[i] >> 2];\n        base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n        base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n        base64 += chars[bytes[i + 2] & 63];\n    }\n    if (len % 3 === 2) {\n        base64 = base64.substring(0, base64.length - 1) + '=';\n    }\n    else if (len % 3 === 1) {\n        base64 = base64.substring(0, base64.length - 2) + '==';\n    }\n    return base64;\n};\nexport const decode = (base64) => {\n    let bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;\n    if (base64[base64.length - 1] === '=') {\n        bufferLength--;\n        if (base64[base64.length - 2] === '=') {\n            bufferLength--;\n        }\n    }\n    const arraybuffer = new ArrayBuffer(bufferLength), bytes = new Uint8Array(arraybuffer);\n    for (i = 0; i < len; i += 4) {\n        encoded1 = lookup[base64.charCodeAt(i)];\n        encoded2 = lookup[base64.charCodeAt(i + 1)];\n        encoded3 = lookup[base64.charCodeAt(i + 2)];\n        encoded4 = lookup[base64.charCodeAt(i + 3)];\n        bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n        bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n        bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n    return arraybuffer;\n};\n","import { ERROR_PACKET, PACKET_TYPES_REVERSE, } from \"./commons.js\";\nimport { decode } from \"./contrib/base64-arraybuffer.js\";\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\nexport const decodePacket = (encodedPacket, binaryType) => {\n    if (typeof encodedPacket !== \"string\") {\n        return {\n            type: \"message\",\n            data: mapBinary(encodedPacket, binaryType),\n        };\n    }\n    const type = encodedPacket.charAt(0);\n    if (type === \"b\") {\n        return {\n            type: \"message\",\n            data: decodeBase64Packet(encodedPacket.substring(1), binaryType),\n        };\n    }\n    const packetType = PACKET_TYPES_REVERSE[type];\n    if (!packetType) {\n        return ERROR_PACKET;\n    }\n    return encodedPacket.length > 1\n        ? {\n            type: PACKET_TYPES_REVERSE[type],\n            data: encodedPacket.substring(1),\n        }\n        : {\n            type: PACKET_TYPES_REVERSE[type],\n        };\n};\nconst decodeBase64Packet = (data, binaryType) => {\n    if (withNativeArrayBuffer) {\n        const decoded = decode(data);\n        return mapBinary(decoded, binaryType);\n    }\n    else {\n        return { base64: true, data }; // fallback for old browsers\n    }\n};\nconst mapBinary = (data, binaryType) => {\n    switch (binaryType) {\n        case \"blob\":\n            if (data instanceof Blob) {\n                // from WebSocket + binaryType \"blob\"\n                return data;\n            }\n            else {\n                // from HTTP long-polling or WebTransport\n                return new Blob([data]);\n            }\n        case \"arraybuffer\":\n        default:\n            if (data instanceof ArrayBuffer) {\n                // from HTTP long-polling (base64) or WebSocket + binaryType \"arraybuffer\"\n                return data;\n            }\n            else {\n                // from WebTransport (Uint8Array)\n                return data.buffer;\n            }\n    }\n};\n","import { encodePacket, encodePacketToBinary } from \"./encodePacket.js\";\nimport { decodePacket } from \"./decodePacket.js\";\nimport { ERROR_PACKET, } from \"./commons.js\";\nconst SEPARATOR = String.fromCharCode(30); // see https://en.wikipedia.org/wiki/Delimiter#ASCII_delimited_text\nconst encodePayload = (packets, callback) => {\n    // some packets may be added to the array while encoding, so the initial length must be saved\n    const length = packets.length;\n    const encodedPackets = new Array(length);\n    let count = 0;\n    packets.forEach((packet, i) => {\n        // force base64 encoding for binary packets\n        encodePacket(packet, false, (encodedPacket) => {\n            encodedPackets[i] = encodedPacket;\n            if (++count === length) {\n                callback(encodedPackets.join(SEPARATOR));\n            }\n        });\n    });\n};\nconst decodePayload = (encodedPayload, binaryType) => {\n    const encodedPackets = encodedPayload.split(SEPARATOR);\n    const packets = [];\n    for (let i = 0; i < encodedPackets.length; i++) {\n        const decodedPacket = decodePacket(encodedPackets[i], binaryType);\n        packets.push(decodedPacket);\n        if (decodedPacket.type === \"error\") {\n            break;\n        }\n    }\n    return packets;\n};\nexport function createPacketEncoderStream() {\n    return new TransformStream({\n        transform(packet, controller) {\n            encodePacketToBinary(packet, (encodedPacket) => {\n                const payloadLength = encodedPacket.length;\n                let header;\n                // inspired by the WebSocket format: https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API/Writing_WebSocket_servers#decoding_payload_length\n                if (payloadLength < 126) {\n                    header = new Uint8Array(1);\n                    new DataView(header.buffer).setUint8(0, payloadLength);\n                }\n                else if (payloadLength < 65536) {\n                    header = new Uint8Array(3);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 126);\n                    view.setUint16(1, payloadLength);\n                }\n                else {\n                    header = new Uint8Array(9);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 127);\n                    view.setBigUint64(1, BigInt(payloadLength));\n                }\n                // first bit indicates whether the payload is plain text (0) or binary (1)\n                if (packet.data && typeof packet.data !== \"string\") {\n                    header[0] |= 0x80;\n                }\n                controller.enqueue(header);\n                controller.enqueue(encodedPacket);\n            });\n        },\n    });\n}\nlet TEXT_DECODER;\nfunction totalLength(chunks) {\n    return chunks.reduce((acc, chunk) => acc + chunk.length, 0);\n}\nfunction concatChunks(chunks, size) {\n    if (chunks[0].length === size) {\n        return chunks.shift();\n    }\n    const buffer = new Uint8Array(size);\n    let j = 0;\n    for (let i = 0; i < size; i++) {\n        buffer[i] = chunks[0][j++];\n        if (j === chunks[0].length) {\n            chunks.shift();\n            j = 0;\n        }\n    }\n    if (chunks.length && j < chunks[0].length) {\n        chunks[0] = chunks[0].slice(j);\n    }\n    return buffer;\n}\nexport function createPacketDecoderStream(maxPayload, binaryType) {\n    if (!TEXT_DECODER) {\n        TEXT_DECODER = new TextDecoder();\n    }\n    const chunks = [];\n    let state = 0 /* State.READ_HEADER */;\n    let expectedLength = -1;\n    let isBinary = false;\n    return new TransformStream({\n        transform(chunk, controller) {\n            chunks.push(chunk);\n            while (true) {\n                if (state === 0 /* State.READ_HEADER */) {\n                    if (totalLength(chunks) < 1) {\n                        break;\n                    }\n                    const header = concatChunks(chunks, 1);\n                    isBinary = (header[0] & 0x80) === 0x80;\n                    expectedLength = header[0] & 0x7f;\n                    if (expectedLength < 126) {\n                        state = 3 /* State.READ_PAYLOAD */;\n                    }\n                    else if (expectedLength === 126) {\n                        state = 1 /* State.READ_EXTENDED_LENGTH_16 */;\n                    }\n                    else {\n                        state = 2 /* State.READ_EXTENDED_LENGTH_64 */;\n                    }\n                }\n                else if (state === 1 /* State.READ_EXTENDED_LENGTH_16 */) {\n                    if (totalLength(chunks) < 2) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 2);\n                    expectedLength = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length).getUint16(0);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else if (state === 2 /* State.READ_EXTENDED_LENGTH_64 */) {\n                    if (totalLength(chunks) < 8) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 8);\n                    const view = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length);\n                    const n = view.getUint32(0);\n                    if (n > Math.pow(2, 53 - 32) - 1) {\n                        // the maximum safe integer in JavaScript is 2^53 - 1\n                        controller.enqueue(ERROR_PACKET);\n                        break;\n                    }\n                    expectedLength = n * Math.pow(2, 32) + view.getUint32(4);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else {\n                    if (totalLength(chunks) < expectedLength) {\n                        break;\n                    }\n                    const data = concatChunks(chunks, expectedLength);\n                    controller.enqueue(decodePacket(isBinary ? data : TEXT_DECODER.decode(data), binaryType));\n                    state = 0 /* State.READ_HEADER */;\n                }\n                if (expectedLength === 0 || expectedLength > maxPayload) {\n                    controller.enqueue(ERROR_PACKET);\n                    break;\n                }\n            }\n        },\n    });\n}\nexport const protocol = 4;\nexport { encodePacket, encodePayload, decodePacket, decodePayload, };\n","export const nextTick = (() => {\n    const isPromiseAvailable = typeof Promise === \"function\" && typeof Promise.resolve === \"function\";\n    if (isPromiseAvailable) {\n        return (cb) => Promise.resolve().then(cb);\n    }\n    else {\n        return (cb, setTimeoutFn) => setTimeoutFn(cb, 0);\n    }\n})();\nexport const globalThisShim = (() => {\n    if (typeof self !== \"undefined\") {\n        return self;\n    }\n    else if (typeof window !== \"undefined\") {\n        return window;\n    }\n    else {\n        return Function(\"return this\")();\n    }\n})();\nexport const defaultBinaryType = \"arraybuffer\";\nexport function createCookieJar() { }\n","import { globalThisShim as globalThis } from \"./globals.node.js\";\nexport function pick(obj, ...attr) {\n    return attr.reduce((acc, k) => {\n        if (obj.hasOwnProperty(k)) {\n            acc[k] = obj[k];\n        }\n        return acc;\n    }, {});\n}\n// Keep a reference to the real timeout functions so they can be used when overridden\nconst NATIVE_SET_TIMEOUT = globalThis.setTimeout;\nconst NATIVE_CLEAR_TIMEOUT = globalThis.clearTimeout;\nexport function installTimerFunctions(obj, opts) {\n    if (opts.useNativeTimers) {\n        obj.setTimeoutFn = NATIVE_SET_TIMEOUT.bind(globalThis);\n        obj.clearTimeoutFn = NATIVE_CLEAR_TIMEOUT.bind(globalThis);\n    }\n    else {\n        obj.setTimeoutFn = globalThis.setTimeout.bind(globalThis);\n        obj.clearTimeoutFn = globalThis.clearTimeout.bind(globalThis);\n    }\n}\n// base64 encoded buffers are about 33% bigger (https://en.wikipedia.org/wiki/Base64)\nconst BASE64_OVERHEAD = 1.33;\n// we could also have used `new Blob([obj]).size`, but it isn't supported in IE9\nexport function byteLength(obj) {\n    if (typeof obj === \"string\") {\n        return utf8Length(obj);\n    }\n    // arraybuffer or blob\n    return Math.ceil((obj.byteLength || obj.size) * BASE64_OVERHEAD);\n}\nfunction utf8Length(str) {\n    let c = 0, length = 0;\n    for (let i = 0, l = str.length; i < l; i++) {\n        c = str.charCodeAt(i);\n        if (c < 0x80) {\n            length += 1;\n        }\n        else if (c < 0x800) {\n            length += 2;\n        }\n        else if (c < 0xd800 || c >= 0xe000) {\n            length += 3;\n        }\n        else {\n            i++;\n            length += 4;\n        }\n    }\n    return length;\n}\n/**\n * Generates a random 8-characters string.\n */\nexport function randomString() {\n    return (Date.now().toString(36).substring(3) +\n        Math.random().toString(36).substring(2, 5));\n}\n","import { decodePacket } from \"engine.io-parser\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions } from \"./util.js\";\nimport { encode } from \"./contrib/parseqs.js\";\nexport class TransportError extends Error {\n    constructor(reason, description, context) {\n        super(reason);\n        this.description = description;\n        this.context = context;\n        this.type = \"TransportError\";\n    }\n}\nexport class Transport extends Emitter {\n    /**\n     * Transport abstract constructor.\n     *\n     * @param {Object} opts - options\n     * @protected\n     */\n    constructor(opts) {\n        super();\n        this.writable = false;\n        installTimerFunctions(this, opts);\n        this.opts = opts;\n        this.query = opts.query;\n        this.socket = opts.socket;\n        this.supportsBinary = !opts.forceBase64;\n    }\n    /**\n     * Emits an error.\n     *\n     * @param {String} reason\n     * @param description\n     * @param context - the error context\n     * @return {Transport} for chaining\n     * @protected\n     */\n    onError(reason, description, context) {\n        super.emitReserved(\"error\", new TransportError(reason, description, context));\n        return this;\n    }\n    /**\n     * Opens the transport.\n     */\n    open() {\n        this.readyState = \"opening\";\n        this.doOpen();\n        return this;\n    }\n    /**\n     * Closes the transport.\n     */\n    close() {\n        if (this.readyState === \"opening\" || this.readyState === \"open\") {\n            this.doClose();\n            this.onClose();\n        }\n        return this;\n    }\n    /**\n     * Sends multiple packets.\n     *\n     * @param {Array} packets\n     */\n    send(packets) {\n        if (this.readyState === \"open\") {\n            this.write(packets);\n        }\n        else {\n            // this might happen if the transport was silently closed in the beforeunload event handler\n        }\n    }\n    /**\n     * Called upon open\n     *\n     * @protected\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        this.writable = true;\n        super.emitReserved(\"open\");\n    }\n    /**\n     * Called with data.\n     *\n     * @param {String} data\n     * @protected\n     */\n    onData(data) {\n        const packet = decodePacket(data, this.socket.binaryType);\n        this.onPacket(packet);\n    }\n    /**\n     * Called with a decoded packet.\n     *\n     * @protected\n     */\n    onPacket(packet) {\n        super.emitReserved(\"packet\", packet);\n    }\n    /**\n     * Called upon close.\n     *\n     * @protected\n     */\n    onClose(details) {\n        this.readyState = \"closed\";\n        super.emitReserved(\"close\", details);\n    }\n    /**\n     * Pauses the transport, in order not to lose packets during an upgrade.\n     *\n     * @param onPause\n     */\n    pause(onPause) { }\n    createUri(schema, query = {}) {\n        return (schema +\n            \"://\" +\n            this._hostname() +\n            this._port() +\n            this.opts.path +\n            this._query(query));\n    }\n    _hostname() {\n        const hostname = this.opts.hostname;\n        return hostname.indexOf(\":\") === -1 ? hostname : \"[\" + hostname + \"]\";\n    }\n    _port() {\n        if (this.opts.port &&\n            ((this.opts.secure && Number(this.opts.port !== 443)) ||\n                (!this.opts.secure && Number(this.opts.port) !== 80))) {\n            return \":\" + this.opts.port;\n        }\n        else {\n            return \"\";\n        }\n    }\n    _query(query) {\n        const encodedQuery = encode(query);\n        return encodedQuery.length ? \"?\" + encodedQuery : \"\";\n    }\n}\n","// imported from https://github.com/galkn/querystring\n/**\n * Compiles a querystring\n * Returns string representation of the object\n *\n * @param {Object}\n * @api private\n */\nexport function encode(obj) {\n    let str = '';\n    for (let i in obj) {\n        if (obj.hasOwnProperty(i)) {\n            if (str.length)\n                str += '&';\n            str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);\n        }\n    }\n    return str;\n}\n/**\n * Parses a simple querystring into an object\n *\n * @param {String} qs\n * @api private\n */\nexport function decode(qs) {\n    let qry = {};\n    let pairs = qs.split('&');\n    for (let i = 0, l = pairs.length; i < l; i++) {\n        let pair = pairs[i].split('=');\n        qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n    }\n    return qry;\n}\n","import { Transport } from \"../transport.js\";\nimport { randomString } from \"../util.js\";\nimport { encodePayload, decodePayload } from \"engine.io-parser\";\nexport class Polling extends Transport {\n    constructor() {\n        super(...arguments);\n        this._polling = false;\n    }\n    get name() {\n        return \"polling\";\n    }\n    /**\n     * Opens the socket (triggers polling). We write a PING message to determine\n     * when the transport is open.\n     *\n     * @protected\n     */\n    doOpen() {\n        this._poll();\n    }\n    /**\n     * Pauses polling.\n     *\n     * @param {Function} onPause - callback upon buffers are flushed and transport is paused\n     * @package\n     */\n    pause(onPause) {\n        this.readyState = \"pausing\";\n        const pause = () => {\n            this.readyState = \"paused\";\n            onPause();\n        };\n        if (this._polling || !this.writable) {\n            let total = 0;\n            if (this._polling) {\n                total++;\n                this.once(\"pollComplete\", function () {\n                    --total || pause();\n                });\n            }\n            if (!this.writable) {\n                total++;\n                this.once(\"drain\", function () {\n                    --total || pause();\n                });\n            }\n        }\n        else {\n            pause();\n        }\n    }\n    /**\n     * Starts polling cycle.\n     *\n     * @private\n     */\n    _poll() {\n        this._polling = true;\n        this.doPoll();\n        this.emitReserved(\"poll\");\n    }\n    /**\n     * Overloads onData to detect payloads.\n     *\n     * @protected\n     */\n    onData(data) {\n        const callback = (packet) => {\n            // if its the first message we consider the transport open\n            if (\"opening\" === this.readyState && packet.type === \"open\") {\n                this.onOpen();\n            }\n            // if its a close packet, we close the ongoing requests\n            if (\"close\" === packet.type) {\n                this.onClose({ description: \"transport closed by the server\" });\n                return false;\n            }\n            // otherwise bypass onData and handle the message\n            this.onPacket(packet);\n        };\n        // decode payload\n        decodePayload(data, this.socket.binaryType).forEach(callback);\n        // if an event did not trigger closing\n        if (\"closed\" !== this.readyState) {\n            // if we got data we're not polling\n            this._polling = false;\n            this.emitReserved(\"pollComplete\");\n            if (\"open\" === this.readyState) {\n                this._poll();\n            }\n            else {\n            }\n        }\n    }\n    /**\n     * For polling, send a close packet.\n     *\n     * @protected\n     */\n    doClose() {\n        const close = () => {\n            this.write([{ type: \"close\" }]);\n        };\n        if (\"open\" === this.readyState) {\n            close();\n        }\n        else {\n            // in case we're trying to close while\n            // handshaking is in progress (GH-164)\n            this.once(\"open\", close);\n        }\n    }\n    /**\n     * Writes a packets payload.\n     *\n     * @param {Array} packets - data packets\n     * @protected\n     */\n    write(packets) {\n        this.writable = false;\n        encodePayload(packets, (data) => {\n            this.doWrite(data, () => {\n                this.writable = true;\n                this.emitReserved(\"drain\");\n            });\n        });\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? \"https\" : \"http\";\n        const query = this.query || {};\n        // cache busting is forced\n        if (false !== this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = randomString();\n        }\n        if (!this.supportsBinary && !query.sid) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\n","// imported from https://github.com/component/has-cors\nlet value = false;\ntry {\n    value = typeof XMLHttpRequest !== 'undefined' &&\n        'withCredentials' in new XMLHttpRequest();\n}\ncatch (err) {\n    // if XMLHttp support is disabled in IE then it will throw\n    // when trying to create\n}\nexport const hasCORS = value;\n","import { Polling } from \"./polling.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions, pick } from \"../util.js\";\nimport { globalThisShim as globalThis } from \"../globals.node.js\";\nimport { hasCORS } from \"../contrib/has-cors.js\";\nfunction empty() { }\nexport class BaseXHR extends Polling {\n    /**\n     * XHR Polling constructor.\n     *\n     * @param {Object} opts\n     * @package\n     */\n    constructor(opts) {\n        super(opts);\n        if (typeof location !== \"undefined\") {\n            const isSSL = \"https:\" === location.protocol;\n            let port = location.port;\n            // some user agents have empty `location.port`\n            if (!port) {\n                port = isSSL ? \"443\" : \"80\";\n            }\n            this.xd =\n                (typeof location !== \"undefined\" &&\n                    opts.hostname !== location.hostname) ||\n                    port !== opts.port;\n        }\n    }\n    /**\n     * Sends data.\n     *\n     * @param {String} data to send.\n     * @param {Function} called upon flush.\n     * @private\n     */\n    doWrite(data, fn) {\n        const req = this.request({\n            method: \"POST\",\n            data: data,\n        });\n        req.on(\"success\", fn);\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr post error\", xhrStatus, context);\n        });\n    }\n    /**\n     * Starts a poll cycle.\n     *\n     * @private\n     */\n    doPoll() {\n        const req = this.request();\n        req.on(\"data\", this.onData.bind(this));\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr poll error\", xhrStatus, context);\n        });\n        this.pollXhr = req;\n    }\n}\nexport class Request extends Emitter {\n    /**\n     * Request constructor\n     *\n     * @param {Object} options\n     * @package\n     */\n    constructor(createRequest, uri, opts) {\n        super();\n        this.createRequest = createRequest;\n        installTimerFunctions(this, opts);\n        this._opts = opts;\n        this._method = opts.method || \"GET\";\n        this._uri = uri;\n        this._data = undefined !== opts.data ? opts.data : null;\n        this._create();\n    }\n    /**\n     * Creates the XHR object and sends the request.\n     *\n     * @private\n     */\n    _create() {\n        var _a;\n        const opts = pick(this._opts, \"agent\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"autoUnref\");\n        opts.xdomain = !!this._opts.xd;\n        const xhr = (this._xhr = this.createRequest(opts));\n        try {\n            xhr.open(this._method, this._uri, true);\n            try {\n                if (this._opts.extraHeaders) {\n                    // @ts-ignore\n                    xhr.setDisableHeaderCheck && xhr.setDisableHeaderCheck(true);\n                    for (let i in this._opts.extraHeaders) {\n                        if (this._opts.extraHeaders.hasOwnProperty(i)) {\n                            xhr.setRequestHeader(i, this._opts.extraHeaders[i]);\n                        }\n                    }\n                }\n            }\n            catch (e) { }\n            if (\"POST\" === this._method) {\n                try {\n                    xhr.setRequestHeader(\"Content-type\", \"text/plain;charset=UTF-8\");\n                }\n                catch (e) { }\n            }\n            try {\n                xhr.setRequestHeader(\"Accept\", \"*/*\");\n            }\n            catch (e) { }\n            (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.addCookies(xhr);\n            // ie6 check\n            if (\"withCredentials\" in xhr) {\n                xhr.withCredentials = this._opts.withCredentials;\n            }\n            if (this._opts.requestTimeout) {\n                xhr.timeout = this._opts.requestTimeout;\n            }\n            xhr.onreadystatechange = () => {\n                var _a;\n                if (xhr.readyState === 3) {\n                    (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.parseCookies(\n                    // @ts-ignore\n                    xhr.getResponseHeader(\"set-cookie\"));\n                }\n                if (4 !== xhr.readyState)\n                    return;\n                if (200 === xhr.status || 1223 === xhr.status) {\n                    this._onLoad();\n                }\n                else {\n                    // make sure the `error` event handler that's user-set\n                    // does not throw in the same tick and gets caught here\n                    this.setTimeoutFn(() => {\n                        this._onError(typeof xhr.status === \"number\" ? xhr.status : 0);\n                    }, 0);\n                }\n            };\n            xhr.send(this._data);\n        }\n        catch (e) {\n            // Need to defer since .create() is called directly from the constructor\n            // and thus the 'error' event can only be only bound *after* this exception\n            // occurs.  Therefore, also, we cannot throw here at all.\n            this.setTimeoutFn(() => {\n                this._onError(e);\n            }, 0);\n            return;\n        }\n        if (typeof document !== \"undefined\") {\n            this._index = Request.requestsCount++;\n            Request.requests[this._index] = this;\n        }\n    }\n    /**\n     * Called upon error.\n     *\n     * @private\n     */\n    _onError(err) {\n        this.emitReserved(\"error\", err, this._xhr);\n        this._cleanup(true);\n    }\n    /**\n     * Cleans up house.\n     *\n     * @private\n     */\n    _cleanup(fromError) {\n        if (\"undefined\" === typeof this._xhr || null === this._xhr) {\n            return;\n        }\n        this._xhr.onreadystatechange = empty;\n        if (fromError) {\n            try {\n                this._xhr.abort();\n            }\n            catch (e) { }\n        }\n        if (typeof document !== \"undefined\") {\n            delete Request.requests[this._index];\n        }\n        this._xhr = null;\n    }\n    /**\n     * Called upon load.\n     *\n     * @private\n     */\n    _onLoad() {\n        const data = this._xhr.responseText;\n        if (data !== null) {\n            this.emitReserved(\"data\", data);\n            this.emitReserved(\"success\");\n            this._cleanup();\n        }\n    }\n    /**\n     * Aborts the request.\n     *\n     * @package\n     */\n    abort() {\n        this._cleanup();\n    }\n}\nRequest.requestsCount = 0;\nRequest.requests = {};\n/**\n * Aborts pending requests when unloading the window. This is needed to prevent\n * memory leaks (e.g. when using IE) and to ensure that no spurious error is\n * emitted.\n */\nif (typeof document !== \"undefined\") {\n    // @ts-ignore\n    if (typeof attachEvent === \"function\") {\n        // @ts-ignore\n        attachEvent(\"onunload\", unloadHandler);\n    }\n    else if (typeof addEventListener === \"function\") {\n        const terminationEvent = \"onpagehide\" in globalThis ? \"pagehide\" : \"unload\";\n        addEventListener(terminationEvent, unloadHandler, false);\n    }\n}\nfunction unloadHandler() {\n    for (let i in Request.requests) {\n        if (Request.requests.hasOwnProperty(i)) {\n            Request.requests[i].abort();\n        }\n    }\n}\nconst hasXHR2 = (function () {\n    const xhr = newRequest({\n        xdomain: false,\n    });\n    return xhr && xhr.responseType !== null;\n})();\n/**\n * HTTP long-polling based on the built-in `XMLHttpRequest` object.\n *\n * Usage: browser\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\n */\nexport class XHR extends BaseXHR {\n    constructor(opts) {\n        super(opts);\n        const forceBase64 = opts && opts.forceBase64;\n        this.supportsBinary = hasXHR2 && !forceBase64;\n    }\n    request(opts = {}) {\n        Object.assign(opts, { xd: this.xd }, this.opts);\n        return new Request(newRequest, this.uri(), opts);\n    }\n}\nfunction newRequest(opts) {\n    const xdomain = opts.xdomain;\n    // XMLHttpRequest can be disabled on IE\n    try {\n        if (\"undefined\" !== typeof XMLHttpRequest && (!xdomain || hasCORS)) {\n            return new XMLHttpRequest();\n        }\n    }\n    catch (e) { }\n    if (!xdomain) {\n        try {\n            return new globalThis[[\"Active\"].concat(\"Object\").join(\"X\")](\"Microsoft.XMLHTTP\");\n        }\n        catch (e) { }\n    }\n}\n","import { Transport } from \"../transport.js\";\nimport { pick, randomString } from \"../util.js\";\nimport { encodePacket } from \"engine.io-parser\";\nimport { globalThisShim as globalThis, nextTick } from \"../globals.node.js\";\n// detect ReactNative environment\nconst isReactNative = typeof navigator !== \"undefined\" &&\n    typeof navigator.product === \"string\" &&\n    navigator.product.toLowerCase() === \"reactnative\";\nexport class BaseWS extends Transport {\n    get name() {\n        return \"websocket\";\n    }\n    doOpen() {\n        const uri = this.uri();\n        const protocols = this.opts.protocols;\n        // React Native only supports the 'headers' option, and will print a warning if anything else is passed\n        const opts = isReactNative\n            ? {}\n            : pick(this.opts, \"agent\", \"perMessageDeflate\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"localAddress\", \"protocolVersion\", \"origin\", \"maxPayload\", \"family\", \"checkServerIdentity\");\n        if (this.opts.extraHeaders) {\n            opts.headers = this.opts.extraHeaders;\n        }\n        try {\n            this.ws = this.createSocket(uri, protocols, opts);\n        }\n        catch (err) {\n            return this.emitReserved(\"error\", err);\n        }\n        this.ws.binaryType = this.socket.binaryType;\n        this.addEventListeners();\n    }\n    /**\n     * Adds event listeners to the socket\n     *\n     * @private\n     */\n    addEventListeners() {\n        this.ws.onopen = () => {\n            if (this.opts.autoUnref) {\n                this.ws._socket.unref();\n            }\n            this.onOpen();\n        };\n        this.ws.onclose = (closeEvent) => this.onClose({\n            description: \"websocket connection closed\",\n            context: closeEvent,\n        });\n        this.ws.onmessage = (ev) => this.onData(ev.data);\n        this.ws.onerror = (e) => this.onError(\"websocket error\", e);\n    }\n    write(packets) {\n        this.writable = false;\n        // encodePacket efficient as it uses WS framing\n        // no need for encodePayload\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            encodePacket(packet, this.supportsBinary, (data) => {\n                // Sometimes the websocket has already been closed but the browser didn't\n                // have a chance of informing us about it yet, in that case send will\n                // throw an error\n                try {\n                    this.doWrite(packet, data);\n                }\n                catch (e) {\n                }\n                if (lastPacket) {\n                    // fake drain\n                    // defer to next tick to allow Socket to clear writeBuffer\n                    nextTick(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        if (typeof this.ws !== \"undefined\") {\n            this.ws.onerror = () => { };\n            this.ws.close();\n            this.ws = null;\n        }\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? \"wss\" : \"ws\";\n        const query = this.query || {};\n        // append timestamp to URI\n        if (this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = randomString();\n        }\n        // communicate binary support capabilities\n        if (!this.supportsBinary) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\nconst WebSocketCtor = globalThis.WebSocket || globalThis.MozWebSocket;\n/**\n * WebSocket transport based on the built-in `WebSocket` object.\n *\n * Usage: browser, Node.js (since v21), Deno, Bun\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket\n * @see https://caniuse.com/mdn-api_websocket\n * @see https://nodejs.org/api/globals.html#websocket\n */\nexport class WS extends BaseWS {\n    createSocket(uri, protocols, opts) {\n        return !isReactNative\n            ? protocols\n                ? new WebSocketCtor(uri, protocols)\n                : new WebSocketCtor(uri)\n            : new WebSocketCtor(uri, protocols, opts);\n    }\n    doWrite(_packet, data) {\n        this.ws.send(data);\n    }\n}\n","import { XHR } from \"./polling-xhr.node.js\";\nimport { WS } from \"./websocket.node.js\";\nimport { WT } from \"./webtransport.js\";\nexport const transports = {\n    websocket: WS,\n    webtransport: WT,\n    polling: XHR,\n};\n","import { Transport } from \"../transport.js\";\nimport { nextTick } from \"../globals.node.js\";\nimport { createPacketDecoderStream, createPacketEncoderStream, } from \"engine.io-parser\";\n/**\n * WebTransport transport based on the built-in `WebTransport` object.\n *\n * Usage: browser, Node.js (with the `@fails-components/webtransport` package)\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebTransport\n * @see https://caniuse.com/webtransport\n */\nexport class WT extends Transport {\n    get name() {\n        return \"webtransport\";\n    }\n    doOpen() {\n        try {\n            // @ts-ignore\n            this._transport = new WebTransport(this.createUri(\"https\"), this.opts.transportOptions[this.name]);\n        }\n        catch (err) {\n            return this.emitReserved(\"error\", err);\n        }\n        this._transport.closed\n            .then(() => {\n            this.onClose();\n        })\n            .catch((err) => {\n            this.onError(\"webtransport error\", err);\n        });\n        // note: we could have used async/await, but that would require some additional polyfills\n        this._transport.ready.then(() => {\n            this._transport.createBidirectionalStream().then((stream) => {\n                const decoderStream = createPacketDecoderStream(Number.MAX_SAFE_INTEGER, this.socket.binaryType);\n                const reader = stream.readable.pipeThrough(decoderStream).getReader();\n                const encoderStream = createPacketEncoderStream();\n                encoderStream.readable.pipeTo(stream.writable);\n                this._writer = encoderStream.writable.getWriter();\n                const read = () => {\n                    reader\n                        .read()\n                        .then(({ done, value }) => {\n                        if (done) {\n                            return;\n                        }\n                        this.onPacket(value);\n                        read();\n                    })\n                        .catch((err) => {\n                    });\n                };\n                read();\n                const packet = { type: \"open\" };\n                if (this.query.sid) {\n                    packet.data = `{\"sid\":\"${this.query.sid}\"}`;\n                }\n                this._writer.write(packet).then(() => this.onOpen());\n            });\n        });\n    }\n    write(packets) {\n        this.writable = false;\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            this._writer.write(packet).then(() => {\n                if (lastPacket) {\n                    nextTick(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        var _a;\n        (_a = this._transport) === null || _a === void 0 ? void 0 : _a.close();\n    }\n}\n","// imported from https://github.com/galkn/parseuri\n/**\n * Parses a URI\n *\n * Note: we could also have used the built-in URL object, but it isn't supported on all platforms.\n *\n * See:\n * - https://developer.mozilla.org/en-US/docs/Web/API/URL\n * - https://caniuse.com/url\n * - https://www.rfc-editor.org/rfc/rfc3986#appendix-B\n *\n * History of the parse() method:\n * - first commit: https://github.com/socketio/socket.io-client/commit/4ee1d5d94b3906a9c052b459f1a818b15f38f91c\n * - export into its own module: https://github.com/socketio/engine.io-client/commit/de2c561e4564efeb78f1bdb1ba39ef81b2822cb3\n * - reimport: https://github.com/socketio/engine.io-client/commit/df32277c3f6d622eec5ed09f493cae3f3391d242\n *\n * @author Steven Levithan <stevenlevithan.com> (MIT license)\n * @api private\n */\nconst re = /^(?:(?![^:@\\/?#]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@\\/?#]*)(?::([^:@\\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\nconst parts = [\n    'source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'\n];\nexport function parse(str) {\n    if (str.length > 8000) {\n        throw \"URI too long\";\n    }\n    const src = str, b = str.indexOf('['), e = str.indexOf(']');\n    if (b != -1 && e != -1) {\n        str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);\n    }\n    let m = re.exec(str || ''), uri = {}, i = 14;\n    while (i--) {\n        uri[parts[i]] = m[i] || '';\n    }\n    if (b != -1 && e != -1) {\n        uri.source = src;\n        uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');\n        uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');\n        uri.ipv6uri = true;\n    }\n    uri.pathNames = pathNames(uri, uri['path']);\n    uri.queryKey = queryKey(uri, uri['query']);\n    return uri;\n}\nfunction pathNames(obj, path) {\n    const regx = /\\/{2,9}/g, names = path.replace(regx, \"/\").split(\"/\");\n    if (path.slice(0, 1) == '/' || path.length === 0) {\n        names.splice(0, 1);\n    }\n    if (path.slice(-1) == '/') {\n        names.splice(names.length - 1, 1);\n    }\n    return names;\n}\nfunction queryKey(uri, query) {\n    const data = {};\n    query.replace(/(?:^|&)([^&=]*)=?([^&]*)/g, function ($0, $1, $2) {\n        if ($1) {\n            data[$1] = $2;\n        }\n    });\n    return data;\n}\n","import { transports as DEFAULT_TRANSPORTS } from \"./transports/index.js\";\nimport { installTimerFunctions, byteLength } from \"./util.js\";\nimport { decode } from \"./contrib/parseqs.js\";\nimport { parse } from \"./contrib/parseuri.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { protocol } from \"engine.io-parser\";\nimport { createCookieJar, defaultBinaryType, nextTick, } from \"./globals.node.js\";\nconst withEventListeners = typeof addEventListener === \"function\" &&\n    typeof removeEventListener === \"function\";\nconst OFFLINE_EVENT_LISTENERS = [];\nif (withEventListeners) {\n    // within a ServiceWorker, any event handler for the 'offline' event must be added on the initial evaluation of the\n    // script, so we create one single event listener here which will forward the event to the socket instances\n    addEventListener(\"offline\", () => {\n        OFFLINE_EVENT_LISTENERS.forEach((listener) => listener());\n    }, false);\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes without upgrade mechanism, which means that it will keep the first low-level transport that\n * successfully establishes the connection.\n *\n * In order to allow tree-shaking, there are no transports included, that's why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithoutUpgrade, WebSocket } from \"engine.io-client\";\n *\n * const socket = new SocketWithoutUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithUpgrade\n * @see Socket\n */\nexport class SocketWithoutUpgrade extends Emitter {\n    /**\n     * Socket constructor.\n     *\n     * @param {String|Object} uri - uri or options\n     * @param {Object} opts - options\n     */\n    constructor(uri, opts) {\n        super();\n        this.binaryType = defaultBinaryType;\n        this.writeBuffer = [];\n        this._prevBufferLen = 0;\n        this._pingInterval = -1;\n        this._pingTimeout = -1;\n        this._maxPayload = -1;\n        /**\n         * The expiration timestamp of the {@link _pingTimeoutTimer} object is tracked, in case the timer is throttled and the\n         * callback is not fired on time. This can happen for example when a laptop is suspended or when a phone is locked.\n         */\n        this._pingTimeoutTime = Infinity;\n        if (uri && \"object\" === typeof uri) {\n            opts = uri;\n            uri = null;\n        }\n        if (uri) {\n            const parsedUri = parse(uri);\n            opts.hostname = parsedUri.host;\n            opts.secure =\n                parsedUri.protocol === \"https\" || parsedUri.protocol === \"wss\";\n            opts.port = parsedUri.port;\n            if (parsedUri.query)\n                opts.query = parsedUri.query;\n        }\n        else if (opts.host) {\n            opts.hostname = parse(opts.host).host;\n        }\n        installTimerFunctions(this, opts);\n        this.secure =\n            null != opts.secure\n                ? opts.secure\n                : typeof location !== \"undefined\" && \"https:\" === location.protocol;\n        if (opts.hostname && !opts.port) {\n            // if no port is specified manually, use the protocol default\n            opts.port = this.secure ? \"443\" : \"80\";\n        }\n        this.hostname =\n            opts.hostname ||\n                (typeof location !== \"undefined\" ? location.hostname : \"localhost\");\n        this.port =\n            opts.port ||\n                (typeof location !== \"undefined\" && location.port\n                    ? location.port\n                    : this.secure\n                        ? \"443\"\n                        : \"80\");\n        this.transports = [];\n        this._transportsByName = {};\n        opts.transports.forEach((t) => {\n            const transportName = t.prototype.name;\n            this.transports.push(transportName);\n            this._transportsByName[transportName] = t;\n        });\n        this.opts = Object.assign({\n            path: \"/engine.io\",\n            agent: false,\n            withCredentials: false,\n            upgrade: true,\n            timestampParam: \"t\",\n            rememberUpgrade: false,\n            addTrailingSlash: true,\n            rejectUnauthorized: true,\n            perMessageDeflate: {\n                threshold: 1024,\n            },\n            transportOptions: {},\n            closeOnBeforeunload: false,\n        }, opts);\n        this.opts.path =\n            this.opts.path.replace(/\\/$/, \"\") +\n                (this.opts.addTrailingSlash ? \"/\" : \"\");\n        if (typeof this.opts.query === \"string\") {\n            this.opts.query = decode(this.opts.query);\n        }\n        if (withEventListeners) {\n            if (this.opts.closeOnBeforeunload) {\n                // Firefox closes the connection when the \"beforeunload\" event is emitted but not Chrome. This event listener\n                // ensures every browser behaves the same (no \"disconnect\" event at the Socket.IO level when the page is\n                // closed/reloaded)\n                this._beforeunloadEventListener = () => {\n                    if (this.transport) {\n                        // silently close the transport\n                        this.transport.removeAllListeners();\n                        this.transport.close();\n                    }\n                };\n                addEventListener(\"beforeunload\", this._beforeunloadEventListener, false);\n            }\n            if (this.hostname !== \"localhost\") {\n                this._offlineEventListener = () => {\n                    this._onClose(\"transport close\", {\n                        description: \"network connection lost\",\n                    });\n                };\n                OFFLINE_EVENT_LISTENERS.push(this._offlineEventListener);\n            }\n        }\n        if (this.opts.withCredentials) {\n            this._cookieJar = createCookieJar();\n        }\n        this._open();\n    }\n    /**\n     * Creates transport of the given type.\n     *\n     * @param {String} name - transport name\n     * @return {Transport}\n     * @private\n     */\n    createTransport(name) {\n        const query = Object.assign({}, this.opts.query);\n        // append engine.io protocol identifier\n        query.EIO = protocol;\n        // transport name\n        query.transport = name;\n        // session id if we already have one\n        if (this.id)\n            query.sid = this.id;\n        const opts = Object.assign({}, this.opts, {\n            query,\n            socket: this,\n            hostname: this.hostname,\n            secure: this.secure,\n            port: this.port,\n        }, this.opts.transportOptions[name]);\n        return new this._transportsByName[name](opts);\n    }\n    /**\n     * Initializes transport to use and starts probe.\n     *\n     * @private\n     */\n    _open() {\n        if (this.transports.length === 0) {\n            // Emit error on next tick so it can be listened to\n            this.setTimeoutFn(() => {\n                this.emitReserved(\"error\", \"No transports available\");\n            }, 0);\n            return;\n        }\n        const transportName = this.opts.rememberUpgrade &&\n            SocketWithoutUpgrade.priorWebsocketSuccess &&\n            this.transports.indexOf(\"websocket\") !== -1\n            ? \"websocket\"\n            : this.transports[0];\n        this.readyState = \"opening\";\n        const transport = this.createTransport(transportName);\n        transport.open();\n        this.setTransport(transport);\n    }\n    /**\n     * Sets the current transport. Disables the existing one (if any).\n     *\n     * @private\n     */\n    setTransport(transport) {\n        if (this.transport) {\n            this.transport.removeAllListeners();\n        }\n        // set up transport\n        this.transport = transport;\n        // set up transport listeners\n        transport\n            .on(\"drain\", this._onDrain.bind(this))\n            .on(\"packet\", this._onPacket.bind(this))\n            .on(\"error\", this._onError.bind(this))\n            .on(\"close\", (reason) => this._onClose(\"transport close\", reason));\n    }\n    /**\n     * Called when connection is deemed open.\n     *\n     * @private\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        SocketWithoutUpgrade.priorWebsocketSuccess =\n            \"websocket\" === this.transport.name;\n        this.emitReserved(\"open\");\n        this.flush();\n    }\n    /**\n     * Handles a packet.\n     *\n     * @private\n     */\n    _onPacket(packet) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            this.emitReserved(\"packet\", packet);\n            // Socket is live - any packet counts\n            this.emitReserved(\"heartbeat\");\n            switch (packet.type) {\n                case \"open\":\n                    this.onHandshake(JSON.parse(packet.data));\n                    break;\n                case \"ping\":\n                    this._sendPacket(\"pong\");\n                    this.emitReserved(\"ping\");\n                    this.emitReserved(\"pong\");\n                    this._resetPingTimeout();\n                    break;\n                case \"error\":\n                    const err = new Error(\"server error\");\n                    // @ts-ignore\n                    err.code = packet.data;\n                    this._onError(err);\n                    break;\n                case \"message\":\n                    this.emitReserved(\"data\", packet.data);\n                    this.emitReserved(\"message\", packet.data);\n                    break;\n            }\n        }\n        else {\n        }\n    }\n    /**\n     * Called upon handshake completion.\n     *\n     * @param {Object} data - handshake obj\n     * @private\n     */\n    onHandshake(data) {\n        this.emitReserved(\"handshake\", data);\n        this.id = data.sid;\n        this.transport.query.sid = data.sid;\n        this._pingInterval = data.pingInterval;\n        this._pingTimeout = data.pingTimeout;\n        this._maxPayload = data.maxPayload;\n        this.onOpen();\n        // In case open handler closes socket\n        if (\"closed\" === this.readyState)\n            return;\n        this._resetPingTimeout();\n    }\n    /**\n     * Sets and resets ping timeout timer based on server pings.\n     *\n     * @private\n     */\n    _resetPingTimeout() {\n        this.clearTimeoutFn(this._pingTimeoutTimer);\n        const delay = this._pingInterval + this._pingTimeout;\n        this._pingTimeoutTime = Date.now() + delay;\n        this._pingTimeoutTimer = this.setTimeoutFn(() => {\n            this._onClose(\"ping timeout\");\n        }, delay);\n        if (this.opts.autoUnref) {\n            this._pingTimeoutTimer.unref();\n        }\n    }\n    /**\n     * Called on `drain` event\n     *\n     * @private\n     */\n    _onDrain() {\n        this.writeBuffer.splice(0, this._prevBufferLen);\n        // setting prevBufferLen = 0 is very important\n        // for example, when upgrading, upgrade packet is sent over,\n        // and a nonzero prevBufferLen could cause problems on `drain`\n        this._prevBufferLen = 0;\n        if (0 === this.writeBuffer.length) {\n            this.emitReserved(\"drain\");\n        }\n        else {\n            this.flush();\n        }\n    }\n    /**\n     * Flush write buffers.\n     *\n     * @private\n     */\n    flush() {\n        if (\"closed\" !== this.readyState &&\n            this.transport.writable &&\n            !this.upgrading &&\n            this.writeBuffer.length) {\n            const packets = this._getWritablePackets();\n            this.transport.send(packets);\n            // keep track of current length of writeBuffer\n            // splice writeBuffer and callbackBuffer on `drain`\n            this._prevBufferLen = packets.length;\n            this.emitReserved(\"flush\");\n        }\n    }\n    /**\n     * Ensure the encoded size of the writeBuffer is below the maxPayload value sent by the server (only for HTTP\n     * long-polling)\n     *\n     * @private\n     */\n    _getWritablePackets() {\n        const shouldCheckPayloadSize = this._maxPayload &&\n            this.transport.name === \"polling\" &&\n            this.writeBuffer.length > 1;\n        if (!shouldCheckPayloadSize) {\n            return this.writeBuffer;\n        }\n        let payloadSize = 1; // first packet type\n        for (let i = 0; i < this.writeBuffer.length; i++) {\n            const data = this.writeBuffer[i].data;\n            if (data) {\n                payloadSize += byteLength(data);\n            }\n            if (i > 0 && payloadSize > this._maxPayload) {\n                return this.writeBuffer.slice(0, i);\n            }\n            payloadSize += 2; // separator + packet type\n        }\n        return this.writeBuffer;\n    }\n    /**\n     * Checks whether the heartbeat timer has expired but the socket has not yet been notified.\n     *\n     * Note: this method is private for now because it does not really fit the WebSocket API, but if we put it in the\n     * `write()` method then the message would not be buffered by the Socket.IO client.\n     *\n     * @return {boolean}\n     * @private\n     */\n    /* private */ _hasPingExpired() {\n        if (!this._pingTimeoutTime)\n            return true;\n        const hasExpired = Date.now() > this._pingTimeoutTime;\n        if (hasExpired) {\n            this._pingTimeoutTime = 0;\n            nextTick(() => {\n                this._onClose(\"ping timeout\");\n            }, this.setTimeoutFn);\n        }\n        return hasExpired;\n    }\n    /**\n     * Sends a message.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    write(msg, options, fn) {\n        this._sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a message. Alias of {@link Socket#write}.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    send(msg, options, fn) {\n        this._sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param {String} type: packet type.\n     * @param {String} data.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @private\n     */\n    _sendPacket(type, data, options, fn) {\n        if (\"function\" === typeof data) {\n            fn = data;\n            data = undefined;\n        }\n        if (\"function\" === typeof options) {\n            fn = options;\n            options = null;\n        }\n        if (\"closing\" === this.readyState || \"closed\" === this.readyState) {\n            return;\n        }\n        options = options || {};\n        options.compress = false !== options.compress;\n        const packet = {\n            type: type,\n            data: data,\n            options: options,\n        };\n        this.emitReserved(\"packetCreate\", packet);\n        this.writeBuffer.push(packet);\n        if (fn)\n            this.once(\"flush\", fn);\n        this.flush();\n    }\n    /**\n     * Closes the connection.\n     */\n    close() {\n        const close = () => {\n            this._onClose(\"forced close\");\n            this.transport.close();\n        };\n        const cleanupAndClose = () => {\n            this.off(\"upgrade\", cleanupAndClose);\n            this.off(\"upgradeError\", cleanupAndClose);\n            close();\n        };\n        const waitForUpgrade = () => {\n            // wait for upgrade to finish since we can't send packets while pausing a transport\n            this.once(\"upgrade\", cleanupAndClose);\n            this.once(\"upgradeError\", cleanupAndClose);\n        };\n        if (\"opening\" === this.readyState || \"open\" === this.readyState) {\n            this.readyState = \"closing\";\n            if (this.writeBuffer.length) {\n                this.once(\"drain\", () => {\n                    if (this.upgrading) {\n                        waitForUpgrade();\n                    }\n                    else {\n                        close();\n                    }\n                });\n            }\n            else if (this.upgrading) {\n                waitForUpgrade();\n            }\n            else {\n                close();\n            }\n        }\n        return this;\n    }\n    /**\n     * Called upon transport error\n     *\n     * @private\n     */\n    _onError(err) {\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        if (this.opts.tryAllTransports &&\n            this.transports.length > 1 &&\n            this.readyState === \"opening\") {\n            this.transports.shift();\n            return this._open();\n        }\n        this.emitReserved(\"error\", err);\n        this._onClose(\"transport error\", err);\n    }\n    /**\n     * Called upon transport close.\n     *\n     * @private\n     */\n    _onClose(reason, description) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            // clear timers\n            this.clearTimeoutFn(this._pingTimeoutTimer);\n            // stop event from firing again for transport\n            this.transport.removeAllListeners(\"close\");\n            // ensure transport won't stay open\n            this.transport.close();\n            // ignore further transport communication\n            this.transport.removeAllListeners();\n            if (withEventListeners) {\n                if (this._beforeunloadEventListener) {\n                    removeEventListener(\"beforeunload\", this._beforeunloadEventListener, false);\n                }\n                if (this._offlineEventListener) {\n                    const i = OFFLINE_EVENT_LISTENERS.indexOf(this._offlineEventListener);\n                    if (i !== -1) {\n                        OFFLINE_EVENT_LISTENERS.splice(i, 1);\n                    }\n                }\n            }\n            // set ready state\n            this.readyState = \"closed\";\n            // clear session id\n            this.id = null;\n            // emit close event\n            this.emitReserved(\"close\", reason, description);\n            // clean buffers after, so users can still\n            // grab the buffers on `close` event\n            this.writeBuffer = [];\n            this._prevBufferLen = 0;\n        }\n    }\n}\nSocketWithoutUpgrade.protocol = protocol;\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * In order to allow tree-shaking, there are no transports included, that's why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithUpgrade, WebSocket } from \"engine.io-client\";\n *\n * const socket = new SocketWithUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see Socket\n */\nexport class SocketWithUpgrade extends SocketWithoutUpgrade {\n    constructor() {\n        super(...arguments);\n        this._upgrades = [];\n    }\n    onOpen() {\n        super.onOpen();\n        if (\"open\" === this.readyState && this.opts.upgrade) {\n            for (let i = 0; i < this._upgrades.length; i++) {\n                this._probe(this._upgrades[i]);\n            }\n        }\n    }\n    /**\n     * Probes a transport.\n     *\n     * @param {String} name - transport name\n     * @private\n     */\n    _probe(name) {\n        let transport = this.createTransport(name);\n        let failed = false;\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        const onTransportOpen = () => {\n            if (failed)\n                return;\n            transport.send([{ type: \"ping\", data: \"probe\" }]);\n            transport.once(\"packet\", (msg) => {\n                if (failed)\n                    return;\n                if (\"pong\" === msg.type && \"probe\" === msg.data) {\n                    this.upgrading = true;\n                    this.emitReserved(\"upgrading\", transport);\n                    if (!transport)\n                        return;\n                    SocketWithoutUpgrade.priorWebsocketSuccess =\n                        \"websocket\" === transport.name;\n                    this.transport.pause(() => {\n                        if (failed)\n                            return;\n                        if (\"closed\" === this.readyState)\n                            return;\n                        cleanup();\n                        this.setTransport(transport);\n                        transport.send([{ type: \"upgrade\" }]);\n                        this.emitReserved(\"upgrade\", transport);\n                        transport = null;\n                        this.upgrading = false;\n                        this.flush();\n                    });\n                }\n                else {\n                    const err = new Error(\"probe error\");\n                    // @ts-ignore\n                    err.transport = transport.name;\n                    this.emitReserved(\"upgradeError\", err);\n                }\n            });\n        };\n        function freezeTransport() {\n            if (failed)\n                return;\n            // Any callback called by transport should be ignored since now\n            failed = true;\n            cleanup();\n            transport.close();\n            transport = null;\n        }\n        // Handle any error that happens while probing\n        const onerror = (err) => {\n            const error = new Error(\"probe error: \" + err);\n            // @ts-ignore\n            error.transport = transport.name;\n            freezeTransport();\n            this.emitReserved(\"upgradeError\", error);\n        };\n        function onTransportClose() {\n            onerror(\"transport closed\");\n        }\n        // When the socket is closed while we're probing\n        function onclose() {\n            onerror(\"socket closed\");\n        }\n        // When the socket is upgraded while we're probing\n        function onupgrade(to) {\n            if (transport && to.name !== transport.name) {\n                freezeTransport();\n            }\n        }\n        // Remove all listeners on the transport and on self\n        const cleanup = () => {\n            transport.removeListener(\"open\", onTransportOpen);\n            transport.removeListener(\"error\", onerror);\n            transport.removeListener(\"close\", onTransportClose);\n            this.off(\"close\", onclose);\n            this.off(\"upgrading\", onupgrade);\n        };\n        transport.once(\"open\", onTransportOpen);\n        transport.once(\"error\", onerror);\n        transport.once(\"close\", onTransportClose);\n        this.once(\"close\", onclose);\n        this.once(\"upgrading\", onupgrade);\n        if (this._upgrades.indexOf(\"webtransport\") !== -1 &&\n            name !== \"webtransport\") {\n            // favor WebTransport\n            this.setTimeoutFn(() => {\n                if (!failed) {\n                    transport.open();\n                }\n            }, 200);\n        }\n        else {\n            transport.open();\n        }\n    }\n    onHandshake(data) {\n        this._upgrades = this._filterUpgrades(data.upgrades);\n        super.onHandshake(data);\n    }\n    /**\n     * Filters upgrades, returning only those matching client transports.\n     *\n     * @param {Array} upgrades - server upgrades\n     * @private\n     */\n    _filterUpgrades(upgrades) {\n        const filteredUpgrades = [];\n        for (let i = 0; i < upgrades.length; i++) {\n            if (~this.transports.indexOf(upgrades[i]))\n                filteredUpgrades.push(upgrades[i]);\n        }\n        return filteredUpgrades;\n    }\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * @example\n * import { Socket } from \"engine.io-client\";\n *\n * const socket = new Socket();\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see SocketWithUpgrade\n */\nexport class Socket extends SocketWithUpgrade {\n    constructor(uri, opts = {}) {\n        const o = typeof uri === \"object\" ? uri : opts;\n        if (!o.transports ||\n            (o.transports && typeof o.transports[0] === \"string\")) {\n            o.transports = (o.transports || [\"polling\", \"websocket\", \"webtransport\"])\n                .map((transportName) => DEFAULT_TRANSPORTS[transportName])\n                .filter((t) => !!t);\n        }\n        super(uri, o);\n    }\n}\n"],"names":["allSettledButCanBreak","promises","shouldBreakWhileError","Promise","all","map","promise","i","then","value","status","reason","firstGlobalProp","secondGlobalProp","lastGlobalProp","isIE11","navigator","userAgent","indexOf","shouldSkipProperty","global","p","hasOwnProperty","isNaN","length","window","parent","err","getInlineCode","match","start","end","lastIndexOf","substring","defaultGetPublicPath","entry","_typeof","_URL","URL","location","href","origin","paths","pathname","split","pop","concat","join","e","console","warn","requestIdleCallback","cb","Date","now","setTimeout","didTimeout","timeRemaining","Math","max","evalCache","parseUrl","url","parser","DOMParser","html","parseFromString","scripts","src","ALL_SCRIPT_REGEX","SCRIPT_TAG_REGEX","SCRIPT_SRC_REGEX","SCRIPT_TYPE_REGEX","SCRIPT_ENTRY_REGEX","SCRIPT_ASYNC_REGEX","SCRIPT_CROSSORIGIN_REGEX","SCRIPT_NO_MODULE_REGEX","SCRIPT_MODULE_REGEX","LINK_TAG_REGEX","LINK_PRELOAD_OR_PREFETCH_REGEX","LINK_HREF_REGEX","LINK_AS_FONT","STYLE_TAG_REGEX","STYLE_TYPE_REGEX","STYLE_HREF_REGEX","HTML_COMMENT_REGEX","LINK_IGNORE_REGEX","STYLE_IGNORE_REGEX","SCRIPT_IGNORE_REGEX","hasProtocol","startsWith","getEntirePath","path","baseURI","toString","genLinkReplaceSymbol","linkHref","arguments","undefined","genScriptReplaceSymbol","scriptSrc","async","inlineScriptReplaceSymbol","genIgnoreAssetReplaceSymbol","genModuleScriptReplaceSymbol","moduleSupport","processTpl","tpl","postProcessTemplate","styles","document","createElement","tplResult","template","replace","styleHref","styleIgnore","newHref","push","_match$match","_slicedToArray","test","scriptTag","type","scriptIgnore","moduleScriptIgnore","matchedScriptTypeMatch","matchedScriptType","matchedScriptEntry","matchedScriptSrcMatch","matchedScriptSrc","SyntaxError","asyncScript","crossOriginScript","crossOrigin","every","line","trim","filter","script","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","sym","getOwnPropertyDescriptor","enumerable","apply","_objectSpread","target","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","styleCache","scriptCache","embedHTMLCache","fetch","Error","defaultFetch","bind","defaultGetTemplate","getEmbedHTML","_opts$fetch","embedHTML","_getExternalStyleSheets","styleSheets","reduce","styleSheet","styleSrc","styleSheetContent","isInlineCode","code","_ref","_asyncToGenerator","_regeneratorRuntime","_callee","styleLink","_context","prev","next","abrupt","response","text","message","_","stop","_x","this","results","result","reject","_getExternalScripts","fetchScript","scriptUrl","opts","_ref2","_callee2","fetchOpts","_context2","credentials","content","resolve","_x2","throwNonBlockingError","error","msg","performance","mark","clearMarks","measure","clearMeasures","_execScripts","proxy","_opts$fetch2","_opts$strictGlobal","strictGlobal","success","_opts$error","_opts$beforeExec","beforeExec","_opts$afterExec","afterExec","_opts$scopedGlobalVar2","scopedGlobalVariables","scriptsText","geval","inlineScript","scriptText","_opts$scopedGlobalVar","sourceUrl","scopedGlobalVariableDefinition","eval","getExecutableScript","functionWrappedCode","call","evalCode","exec","noteGlobalProps","lastProp","cnt","hasIframe","frames","getGlobalProp","downloadedScriptText","schedule","resolvePromise","importHTML","autoDecodeResponse","getPublicPath","getTemplate","fn","getDomain","autoDetectCharset","headers","contentType","get","charset","parts","_parts$1$split","encoding","toUpperCase","blob","file","reader","FileReader","onload","onerror","readAsText","readResAsString","assetPublicPath","_processTpl","getExternalScripts","getExternalStyleSheets","execScripts","importEntry","_opts$fetch3","_opts$getTemplate","Array","isArray","_entry$scripts","_entry$styles","_entry$html","getHTMLWithScriptPlaceholder","reduceRight","PACKET_TYPES","create","PACKET_TYPES_REVERSE","ERROR_PACKET","data","withNativeBlob","Blob","prototype","withNativeArrayBuffer","ArrayBuffer","isView","obj","buffer","encodePacket","supportsBinary","callback","encodeBlobAsBase64","fileReader","readAsDataURL","toArray","Uint8Array","byteOffset","byteLength","TEXT_ENCODER","chars","lookup","charCodeAt","decodePacket","encodedPacket","binaryType","mapBinary","charAt","decodeBase64Packet","decoded","base64","encoded1","encoded2","encoded3","encoded4","bufferLength","len","arraybuffer","bytes","decode","SEPARATOR","String","fromCharCode","createPacketEncoderStream","TransformStream","transform","packet","controller","arrayBuffer","encoded","TextEncoder","encode","encodePacketToBinary","payloadLength","header","DataView","setUint8","view","setUint16","setBigUint64","BigInt","enqueue","TEXT_DECODER","totalLength","chunks","acc","chunk","concatChunks","size","shift","j","slice","nextTick","setTimeoutFn","globalThisShim","self","Function","pick","_len","attr","_key","k","NATIVE_SET_TIMEOUT","globalThis","NATIVE_CLEAR_TIMEOUT","clearTimeout","installTimerFunctions","useNativeTimers","clearTimeoutFn","randomString","random","TransportError","constructor","description","context","super","Transport","Emitter","writable","query","socket","forceBase64","onError","emitReserved","open","readyState","doOpen","close","doClose","onClose","send","packets","write","onOpen","onData","onPacket","details","pause","onPause","createUri","schema","_hostname","_port","_query","hostname","port","secure","Number","encodedQuery","str","encodeURIComponent","Polling","_polling","name","_poll","total","once","doPoll","decodePayload","encodedPayload","encodedPackets","decodedPacket","encodePayload","count","doWrite","uri","timestampRequests","timestampParam","sid","b64","XMLHttpRequest","hasCORS","empty","BaseXHR","isSSL","protocol","xd","req","request","method","on","xhrStatus","pollXhr","Request","createRequest","_opts","_method","_uri","_data","_create","_a","xdomain","xhr","_xhr","extraHeaders","setDisableHeaderCheck","setRequestHeader","cookieJar","addCookies","withCredentials","requestTimeout","timeout","onreadystatechange","parseCookies","getResponseHeader","_onLoad","_onError","_index","requestsCount","requests","_cleanup","fromError","abort","responseText","attachEvent","unloadHandler","addEventListener","hasXHR2","newRequest","responseType","isReactNative","product","toLowerCase","BaseWS","protocols","ws","createSocket","addEventListeners","onopen","autoUnref","_socket","unref","onclose","closeEvent","onmessage","ev","lastPacket","WebSocketCtor","WebSocket","MozWebSocket","transports","websocket","_packet","webtransport","_transport","WebTransport","transportOptions","closed","catch","ready","createBidirectionalStream","stream","decoderStream","maxPayload","TextDecoder","state","expectedLength","isBinary","headerArray","getUint16","n","getUint32","pow","createPacketDecoderStream","MAX_SAFE_INTEGER","readable","pipeThrough","getReader","encoderStream","pipeTo","_writer","getWriter","read","done","polling","assign","re","parse","b","m","host","authority","ipv6uri","pathNames","regx","names","splice","queryKey","$0","$1","$2","withEventListeners","removeEventListener","OFFLINE_EVENT_LISTENERS","listener","SocketWithoutUpgrade","writeBuffer","_prevBufferLen","_pingInterval","_pingTimeout","_maxPayload","_pingTimeoutTime","Infinity","parsedUri","_transportsByName","t","transportName","agent","upgrade","rememberUpgrade","addTrailingSlash","rejectUnauthorized","perMessageDeflate","threshold","closeOnBeforeunload","qs","qry","pairs","l","pair","decodeURIComponent","_beforeunloadEventListener","transport","removeAllListeners","_offlineEventListener","_onClose","_cookieJar","createCookieJar","_open","createTransport","EIO","id","priorWebsocketSuccess","setTransport","_onDrain","_onPacket","flush","onHandshake","JSON","_sendPacket","_resetPingTimeout","pingInterval","pingTimeout","_pingTimeoutTimer","delay","upgrading","_getWritablePackets","payloadSize","c","utf8Length","ceil","_hasPingExpired","hasExpired","options","compress","cleanupAndClose","off","waitForUpgrade","tryAllTransports","SocketWithUpgrade","_upgrades","_probe","failed","onTransportOpen","cleanup","freezeTransport","onTransportClose","onupgrade","to","removeListener","_filterUpgrades","upgrades","filteredUpgrades","Socket","o","DEFAULT_TRANSPORTS"],"sourceRoot":""}